{"version":3,"file":"index.js","sources":["../src/contexts/jsvOptions.tsx","../src/components/SchemaRow/state.ts","../src/components/PathCrumbs/state.ts","../src/components/PathCrumbs/index.tsx","../src/consts.ts","../src/hash.ts","../src/guards/isNonNullable.ts","../src/tree/utils.ts","../src/components/shared/Caret.tsx","../src/components/shared/Description.tsx","../src/components/shared/Format.tsx","../src/utils/printName.ts","../src/components/shared/Types.tsx","../src/components/shared/Validations.tsx","../src/components/shared/ChildStack.tsx","../src/components/shared/Properties.tsx","../src/components/SchemaRow/useChoices.ts","../src/components/SchemaRow/SchemaRow.tsx","../src/hooks/useIsOnScreen.ts","../src/components/SchemaRow/TopLevelSchemaRow.tsx","../src/components/JsonSchemaViewer.tsx"],"sourcesContent":["import * as React from 'react';\n\nimport { GoToRefHandler, NodeHasChangedFn, RowAddonRenderer, ViewMode } from '../types';\n\nexport type JSVOptions = {\n  defaultExpandedDepth: number;\n  viewMode: ViewMode;\n  onGoToRef?: GoToRefHandler;\n  renderRowAddon?: RowAddonRenderer;\n  hideExamples?: boolean;\n  renderRootTreeLines?: boolean;\n  disableCrumbs?: boolean;\n  nodeHasChanged?: NodeHasChangedFn;\n};\n\nconst JSVOptionsContext = React.createContext<JSVOptions>({\n  defaultExpandedDepth: 0,\n  viewMode: 'standalone',\n  hideExamples: false,\n});\n\nexport const useJSVOptionsContext = () => React.useContext(JSVOptionsContext);\n\nexport const JSVOptionsContextProvider = JSVOptionsContext.Provider;\n","import { SchemaNode } from '@stoplight/json-schema-tree';\nimport { atom } from 'jotai';\nimport { atomFamily } from 'jotai/utils';\n\nexport const hoveredNodeAtom = atom<SchemaNode | null>(null);\nexport const isNodeHoveredAtom = atomFamily((node: SchemaNode) => atom(get => node === get(hoveredNodeAtom)));\nexport const isChildNodeHoveredAtom = atomFamily((parent: SchemaNode) =>\n  atom(get => {\n    const hoveredNode = get(hoveredNodeAtom);\n\n    if (!hoveredNode || hoveredNode === parent) return false;\n\n    return hoveredNode.parent === parent;\n  }),\n);\n","import { isRegularNode, isRootNode, SchemaNode } from '@stoplight/json-schema-tree';\nimport { atom } from 'jotai';\n\nimport { hoveredNodeAtom } from '../SchemaRow/state';\n\nexport const showPathCrumbsAtom = atom<boolean>(false);\n\nexport const pathCrumbsAtom = atom(get => {\n  const node = get(hoveredNodeAtom);\n\n  if (!node) return [];\n\n  return propertyPathToObjectPath(node as SchemaNode);\n});\n\nfunction propertyPathToObjectPath(node: SchemaNode) {\n  const objectPath: string[] = [];\n\n  let currentNode: SchemaNode | null = node;\n  while (currentNode && !isRootNode(currentNode)) {\n    if (isRegularNode(currentNode)) {\n      const pathPart = currentNode.subpath[currentNode.subpath.length - 1];\n\n      if (currentNode.primaryType === 'array') {\n        const key = `${pathPart || ''}[]`;\n        if (objectPath[objectPath.length - 1]) {\n          objectPath[objectPath.length - 1] = key;\n        } else {\n          objectPath.push(key);\n        }\n      } else if (\n        pathPart &&\n        (currentNode.subpath.length !== 2 || !['allOf', 'oneOf', 'anyOf'].includes(currentNode.subpath[0]))\n      ) {\n        objectPath.push(currentNode.subpath[currentNode.subpath.length - 1]);\n      }\n    }\n\n    currentNode = currentNode.parent;\n  }\n\n  return objectPath.reverse();\n}\n","import { Box, HStack } from '@stoplight/mosaic';\nimport { useAtom } from 'jotai';\nimport * as React from 'react';\n\nimport { useJSVOptionsContext } from '../../contexts';\nimport { pathCrumbsAtom, showPathCrumbsAtom } from './state';\n\nexport const PathCrumbs = ({ parentCrumbs = [] }: { parentCrumbs?: string[] }) => {\n  const [showPathCrumbs] = useAtom(showPathCrumbsAtom);\n  const [pathCrumbs] = useAtom(pathCrumbsAtom);\n  const { disableCrumbs } = useJSVOptionsContext();\n\n  if (disableCrumbs) {\n    return null;\n  }\n\n  const parentCrumbElems: React.ReactNodeArray = [];\n  parentCrumbs.forEach((crumb, i) => {\n    parentCrumbElems.push(<Box key={i}>{crumb}</Box>);\n  });\n\n  const pathCrumbElems: React.ReactNodeArray = [];\n  pathCrumbs.forEach((crumb, i) => {\n    if (pathCrumbs[i + 1]) {\n      pathCrumbElems.push(<Box key={i}>{crumb}</Box>);\n    } else {\n      pathCrumbElems.push(\n        <Box key={i} color=\"body\" fontWeight=\"semibold\">\n          {crumb}\n        </Box>,\n      );\n    }\n  });\n\n  // only show when have a path, and only when we've scrolled enough such that a portion of the JSV is no longer visible\n  if (!showPathCrumbs || (!parentCrumbElems.length && !pathCrumbElems.length)) {\n    return null;\n  }\n\n  return (\n    <HStack\n      spacing={1}\n      divider={<Box>/</Box>}\n      h=\"md\"\n      // so that the crumbs take up no space in the dom, and thus do not push content down when they appear\n      mt={-8}\n      borderB\n      pos=\"sticky\"\n      top={0}\n      fontFamily=\"mono\"\n      fontSize=\"sm\"\n      lineHeight=\"none\"\n      zIndex={10}\n      bg=\"canvas-pure\"\n      px=\"px\"\n      color=\"light\"\n      alignItems=\"center\"\n    >\n      {parentCrumbElems}\n      {pathCrumbElems.length && <HStack divider={<Box fontWeight=\"bold\">.</Box>}>{pathCrumbElems}</HStack>}\n    </HStack>\n  );\n};\n","import { SchemaCombinerName } from '@stoplight/json-schema-tree';\nimport { SpaceVals } from '@stoplight/mosaic';\nimport { Dictionary } from '@stoplight/types';\n\nexport const COMBINER_PRETTY_NAMES: Readonly<Dictionary<string, SchemaCombinerName>> = {\n  [SchemaCombinerName.AllOf]: 'and',\n  [SchemaCombinerName.AnyOf]: 'and/or',\n  [SchemaCombinerName.OneOf]: 'or',\n};\n\nexport const COMMON_JSON_SCHEMA_AND_OAS_FORMATS = {\n  // strings are omitted because they are the default type to apply format to\n  number: ['byte', 'int32', 'int64', 'float', 'double'],\n  get integer() {\n    return this.number;\n  },\n};\n\nexport const NESTING_OFFSET: SpaceVals = 3;\n\nexport const CARET_ICON_SIZE = 'sm';\n\nexport const COMBINER_NAME_MAP: Dictionary<string, SchemaCombinerName> = {\n  allOf: 'all of',\n  anyOf: 'any of',\n  oneOf: 'one of',\n};\n","import type { SchemaNode } from '@stoplight/json-schema-tree';\n// @ts-expect-error: no types\nimport * as fnv from 'fnv-plus';\n\n// for easier debugging the values going into hash\nlet SKIP_HASHING = false;\n\nexport const setSkipHashing = (skip: boolean) => {\n  SKIP_HASHING = skip;\n};\n\nexport const hash = (value: string, skipHashing: boolean = SKIP_HASHING): string => {\n  // Never change this, as it would affect how the default stable id is generated, and cause mismatches with whatever\n  // we already have stored in our DB etc.\n  return skipHashing ? value : fnv.fast1a52hex(value);\n};\n\nexport const getNodeId = (node: SchemaNode, parentId?: string): string => {\n  const nodeId = node.fragment?.['x-stoplight']?.id;\n  if (nodeId) return nodeId;\n\n  const key = node.path[node.path.length - 1];\n\n  return hash(['schema_property', parentId, String(key)].join('-'));\n};\n\nexport const getOriginalNodeId = (node: SchemaNode, parentId?: string): string => {\n  // @ts-expect-error originalFragment does exist...\n  const nodeId = node.originalFragment?.['x-stoplight']?.id;\n  if (nodeId) return nodeId;\n\n  const key = node.path[node.path.length - 1];\n\n  return hash(['schema_property', parentId, String(key)].join('-'));\n};\n","export function isNonNullable<T = unknown>(maybeNullable: T): maybeNullable is NonNullable<T> {\n  return maybeNullable !== void 0 && maybeNullable !== null;\n}\n","import {\n  isReferenceNode,\n  isRegularNode,\n  MirroredSchemaNode,\n  ReferenceNode,\n  RegularNode,\n  SchemaNode,\n  SchemaNodeKind,\n} from '@stoplight/json-schema-tree';\n\nimport { isNonNullable } from '../guards/isNonNullable';\nimport { ComplexArrayNode, FlattenableNode, PrimitiveArrayNode } from './types';\n\nexport type ChildNode = RegularNode | ReferenceNode | MirroredSchemaNode;\n\nexport const isNonEmptyParentNode = (\n  node: SchemaNode,\n): node is RegularNode & {\n  children: ChildNode[] & { 0: ChildNode };\n} => isRegularNode(node) && !!node.children && node.children.length > 0;\n\nexport function isFlattenableNode(node: SchemaNode): node is FlattenableNode {\n  if (!isRegularNode(node)) return false;\n\n  if (node.primaryType !== SchemaNodeKind.Array || !isNonNullable(node.children) || node.children.length === 0) {\n    return false;\n  }\n\n  return (\n    node.children.length === 1 &&\n    (isRegularNode(node.children[0]) || (isReferenceNode(node.children[0]) && node.children[0].error !== null))\n  );\n}\n\nexport function isPrimitiveArray(node: SchemaNode): node is PrimitiveArrayNode {\n  return isFlattenableNode(node) && isRegularNode(node.children[0]) && node.children[0].simple;\n}\n\nexport function isComplexArray(node: SchemaNode): node is ComplexArrayNode {\n  return isFlattenableNode(node) && isRegularNode(node.children[0]) && !node.children[0].simple;\n}\n\n/**\n * Returns the children of `node` that should be displayed in the tree.\n * Defaults to `node.children`, except for Arrays that get special handling (flattening).\n */\nexport function calculateChildrenToShow(node: SchemaNode): SchemaNode[] {\n  if (!isRegularNode(node) || isPrimitiveArray(node)) {\n    return [];\n  }\n  if (isComplexArray(node)) {\n    // flatten the tree here, and show the properties of the item type directly\n    return node.children[0].children ?? [];\n  }\n  return node.children ?? [];\n}\n\nexport function isPropertyRequired(schemaNode: SchemaNode): boolean {\n  const { parent } = schemaNode;\n  if (parent === null || !isRegularNode(parent) || schemaNode.subpath.length === 0) {\n    return false;\n  }\n\n  return !!parent.required?.includes(schemaNode.subpath[schemaNode.subpath.length - 1]);\n}\n","import { Flex, Icon } from '@stoplight/mosaic';\nimport * as React from 'react';\n\nimport { CARET_ICON_SIZE } from '../../consts';\n\nexport interface ICaret {\n  isExpanded: boolean;\n}\n\nexport const Caret: React.FunctionComponent<ICaret> = ({ isExpanded }) => (\n  <Flex pl={3} w={8} ml={-8} color=\"muted\" role=\"button\" justifyContent=\"center\">\n    <Icon size={CARET_ICON_SIZE} fixedWidth icon={isExpanded ? 'chevron-down' : 'chevron-right'} />\n  </Flex>\n);\n","import { MarkdownViewer } from '@stoplight/markdown-viewer';\nimport { Box, Link, Text } from '@stoplight/mosaic';\nimport * as React from 'react';\n\nexport const Description: React.FunctionComponent<{ value: unknown }> = ({ value }) => {\n  const [showAll, setShowAll] = React.useState(false);\n\n  if (typeof value !== 'string' || value.trim().length === 0) return null;\n\n  const paragraphs = value.split('\\n\\n');\n\n  if (paragraphs.length <= 1 || showAll) {\n    return (\n      <Box\n        as={MarkdownViewer}\n        markdown={value}\n        style={{\n          fontSize: 12,\n        }}\n      />\n    );\n  }\n\n  const firstParagraph = paragraphs[0];\n\n  return (\n    <Box\n      as={MarkdownViewer}\n      markdown={firstParagraph}\n      parseOptions={{\n        components: {\n          p: (props: any) => {\n            return (\n              <Box as=\"p\">\n                <Text mr={1}>{props.children}</Text>\n                <Link cursor=\"pointer\" onClick={() => setShowAll(true)}>\n                  Show all...\n                </Link>\n              </Box>\n            );\n          },\n        },\n      }}\n      style={{\n        fontSize: 12,\n      }}\n    />\n  );\n};\n","import { Box } from '@stoplight/mosaic';\nimport * as React from 'react';\n\ntype FormatProps = {\n  format: string;\n};\n\nexport const Format: React.FunctionComponent<FormatProps> = ({ format }) => {\n  return <Box as=\"span\" color=\"muted\">{`<${format}>`}</Box>;\n};\n","import { getLastPathSegment } from '@stoplight/json';\nimport { isReferenceNode, isRegularNode, RegularNode, SchemaNodeKind } from '@stoplight/json-schema-tree';\nimport upperFirst from 'lodash/upperFirst.js';\n\nimport { isNonNullable } from '../guards/isNonNullable';\nimport { isComplexArray, isPrimitiveArray } from '../tree';\n\ntype PrintNameOptions = {\n  shouldUseRefNameFallback?: boolean;\n};\n\nexport function printName(\n  schemaNode: RegularNode,\n  { shouldUseRefNameFallback = false }: PrintNameOptions = {},\n): string | undefined {\n  if (\n    schemaNode.primaryType !== SchemaNodeKind.Array ||\n    !isNonNullable(schemaNode.children) ||\n    schemaNode.children.length === 0\n  ) {\n    return schemaNode.title ?? (shouldUseRefNameFallback ? getNodeNameFromOriginalRef(schemaNode) : undefined);\n  }\n\n  return printArrayName(schemaNode, { shouldUseRefNameFallback });\n}\n\nfunction printArrayName(\n  schemaNode: RegularNode,\n  { shouldUseRefNameFallback = false }: PrintNameOptions,\n): string | undefined {\n  if (!isNonNullable(schemaNode.children) || schemaNode.children.length === 0) {\n    return schemaNode.title ?? (shouldUseRefNameFallback ? getNodeNameFromOriginalRef(schemaNode) : undefined);\n  }\n\n  if (schemaNode.children.length === 1 && isReferenceNode(schemaNode.children[0])) {\n    return `$ref(${schemaNode.children[0].value})[]`;\n  }\n\n  if (isPrimitiveArray(schemaNode)) {\n    const val =\n      schemaNode.children?.reduce<SchemaNodeKind[] | null>((mergedTypes, child) => {\n        if (mergedTypes === null) return null;\n\n        if (!isRegularNode(child)) return null;\n\n        if (child.types !== null && child.types.length > 0) {\n          for (const type of child.types) {\n            if (mergedTypes.includes(type)) continue;\n            mergedTypes.push(type);\n          }\n        }\n\n        return mergedTypes;\n      }, []) ?? null;\n\n    return val !== null && val.length > 0 ? `array[${val.join(' or ')}]` : 'array';\n  }\n\n  if (isComplexArray(schemaNode)) {\n    const firstChild = schemaNode.children[0];\n    if (firstChild.title) {\n      return `array[${firstChild.title}]`;\n    } else if (shouldUseRefNameFallback && getNodeNameFromOriginalRef(schemaNode)) {\n      return `array[${getNodeNameFromOriginalRef(schemaNode)}]`;\n    } else if (firstChild.primaryType) {\n      return `array[${firstChild.primaryType}]`;\n    } else if (firstChild.combiners?.length) {\n      return `array[${firstChild.combiners.join('/')}]`;\n    }\n    return 'array';\n  }\n\n  return undefined;\n}\n\nfunction getNodeNameFromOriginalRef(node: RegularNode) {\n  if (typeof node.originalFragment.$ref === 'string') {\n    return upperFirst(getLastPathSegment(node.originalFragment.$ref));\n  }\n  return undefined;\n}\n","import {\n  isReferenceNode,\n  isRegularNode,\n  RegularNode,\n  SchemaCombinerName,\n  SchemaNode,\n  SchemaNodeKind,\n} from '@stoplight/json-schema-tree';\nimport { Box } from '@stoplight/mosaic';\nimport * as React from 'react';\n\nimport { COMMON_JSON_SCHEMA_AND_OAS_FORMATS } from '../../consts';\nimport { isPrimitiveArray } from '../../tree';\nimport { printName } from '../../utils';\nimport { Format } from './Format';\n\nfunction shouldRenderName(type: SchemaNodeKind | SchemaCombinerName | '$ref'): boolean {\n  return type === SchemaNodeKind.Array || type === SchemaNodeKind.Object || type === '$ref';\n}\n\nfunction getTypes(schemaNode: RegularNode): Array<SchemaNodeKind | SchemaCombinerName> {\n  return [schemaNode.types, schemaNode.combiners].reduce<Array<SchemaNodeKind | SchemaCombinerName>>(\n    (values, value) => {\n      if (value === null) {\n        return values;\n      }\n\n      values.push(...value);\n      return values;\n    },\n    [],\n  );\n}\n\nfunction getFormats(schemaNode: RegularNode): Partial<Record<SchemaNodeKind, string>> {\n  const formats: Partial<Record<SchemaNodeKind, string>> = {};\n\n  if (isPrimitiveArray(schemaNode) && schemaNode.children[0].format !== null) {\n    formats.array = schemaNode.children[0].format;\n  }\n\n  if (schemaNode.format === null) {\n    return formats;\n  }\n\n  const types = getTypes(schemaNode);\n\n  for (const type of types) {\n    if (!(type in COMMON_JSON_SCHEMA_AND_OAS_FORMATS)) continue;\n\n    if (COMMON_JSON_SCHEMA_AND_OAS_FORMATS[type].includes(schemaNode.format)) {\n      formats[type] = schemaNode.format;\n      return formats;\n    }\n  }\n\n  formats.string = schemaNode.format;\n  return formats;\n}\n\nexport const Types: React.FunctionComponent<{ schemaNode: SchemaNode }> = ({ schemaNode }) => {\n  if (isReferenceNode(schemaNode)) {\n    return (\n      <Box as=\"span\" textOverflow=\"truncate\">\n        {schemaNode.value ?? '$ref'}\n      </Box>\n    );\n  }\n\n  if (!isRegularNode(schemaNode)) {\n    return null;\n  }\n\n  const types = getTypes(schemaNode);\n  const formats = getFormats(schemaNode);\n\n  if (types.length === 0) {\n    return formats.string !== void 0 ? <Format format={formats.string} /> : null;\n  }\n\n  const rendered = types.map((type, i, { length }) => (\n    <React.Fragment key={type}>\n      <Box as=\"span\" textOverflow=\"truncate\" color=\"muted\">\n        {shouldRenderName(type) ? printName(schemaNode) ?? type : type}\n      </Box>\n\n      {type in formats ? <Format format={formats[type]} /> : null}\n\n      {i < length - 1 && (\n        <Box as=\"span\" key={`${i}-sep`} color=\"muted\">\n          {' or '}\n        </Box>\n      )}\n    </React.Fragment>\n  ));\n\n  return rendered.length > 1 ? <Box textOverflow=\"truncate\">{rendered}</Box> : <>{rendered}</>;\n};\nTypes.displayName = 'JsonSchemaViewer.Types';\n","import { isRegularNode, RegularNode, SchemaNode } from '@stoplight/json-schema-tree';\nimport { Flex, HStack, Text } from '@stoplight/mosaic';\nimport { Dictionary } from '@stoplight/types';\nimport capitalize from 'lodash/capitalize.js';\nimport keys from 'lodash/keys.js';\nimport omit from 'lodash/omit.js';\nimport pick from 'lodash/pick.js';\nimport uniq from 'lodash/uniq.js';\nimport * as React from 'react';\n\nexport interface IValidations {\n  validations: Dictionary<unknown>;\n  hideExamples?: boolean;\n}\n\ntype ValidationFormat = {\n  name: string;\n  values: string[];\n};\n\nexport const numberValidationNames = [\n  'minimum',\n  'maximum',\n  'minLength',\n  'maxLength',\n  'minItems',\n  'maxItems',\n  'exclusiveMinimum',\n  'exclusiveMaximum',\n];\n\nconst exampleValidationNames = ['examples'];\n\nconst excludedValidations = ['exclusiveMinimum', 'exclusiveMaximum', 'readOnly', 'writeOnly'];\n\nconst numberValidationFormatters: Record<string, (value: unknown) => string> = {\n  minimum: value => `>= ${value}`,\n  exclusiveMinimum: value => `> ${value}`,\n  minItems: value => `>= ${value} items`,\n  minLength: value => `>= ${value} characters`,\n  maximum: value => `<= ${value}`,\n  exclusiveMaximum: value => `< ${value}`,\n  maxItems: value => `<= ${value} items`,\n  maxLength: value => `<= ${value} characters`,\n};\n\nconst createStringFormatter = (nowrap: boolean | undefined) => (value: unknown) => {\n  return nowrap && typeof value === 'string' ? value : JSON.stringify(value);\n};\n\nconst createValidationsFormatter =\n  (name: string, options?: { exact?: boolean; nowrap?: boolean }) =>\n  (value: unknown[] | unknown): ValidationFormat | null => {\n    const values = Array.isArray(value) ? value : [value];\n    if (values.length) {\n      return {\n        name: options?.exact ? name : values.length > 1 ? `${name}s` : `${name}`,\n        values: values.map(createStringFormatter(options?.nowrap)),\n      };\n    }\n    return null;\n  };\n\nconst validationFormatters: Record<string, (value: unknown) => ValidationFormat | null> = {\n  enum: createValidationsFormatter('Allowed value', { nowrap: true }),\n  examples: createValidationsFormatter('Example', { nowrap: true }),\n  multipleOf: createValidationsFormatter('Multiple of', { exact: true }),\n  pattern: createValidationsFormatter('Match pattern', { exact: true, nowrap: true }),\n  default: createValidationsFormatter('Default', { exact: true, nowrap: true }),\n  style: createValidationsFormatter('Style', { exact: true, nowrap: true }),\n};\n\nconst oasFormats = {\n  int32: {\n    minimum: 0 - 2 ** 31,\n    maximum: 2 ** 31 - 1,\n  },\n  int64: {\n    minimum: 0 - 2 ** 63,\n    maximum: 2 ** 63 - 1,\n  },\n  float: {\n    minimum: 0 - 2 ** 128,\n    maximum: 2 ** 128 - 1,\n  },\n  double: {\n    minimum: 0 - Number.MAX_VALUE,\n    maximum: Number.MAX_VALUE,\n  },\n  byte: {\n    pattern: '^[\\\\w\\\\d+\\\\/=]*$',\n  },\n};\n\nfunction filterOutOasFormatValidations(format: string, values: Dictionary<unknown>) {\n  if (!(format in oasFormats)) return values;\n\n  const newValues = { ...values };\n\n  for (const [key, value] of Object.entries(oasFormats[format])) {\n    if (value === newValues[key]) {\n      delete newValues[key];\n    }\n  }\n\n  return newValues;\n}\n\nexport const Validations: React.FunctionComponent<IValidations> = ({ validations, hideExamples }) => {\n  const numberValidations = pick(validations, numberValidationNames);\n  const keyValueValidations = omit(validations, [\n    ...keys(numberValidations),\n    ...excludedValidations,\n    ...(hideExamples ? exampleValidationNames : []),\n  ]);\n\n  return (\n    <>\n      <NumberValidations validations={numberValidations} />\n      <KeyValueValidations validations={keyValueValidations} />\n    </>\n  );\n};\n\nconst NumberValidations = ({\n  validations,\n}: {\n  validations: Partial<Record<typeof numberValidationNames[number], unknown>>;\n}) => {\n  const entries = Object.entries(validations);\n  if (!entries.length) {\n    return null;\n  }\n  return (\n    <HStack color=\"muted\" maxW=\"full\" spacing={1}>\n      {entries\n        .map(([key, value]) => numberValidationFormatters[key](value))\n        .map((value, i) => (\n          <Value key={i} name={value} />\n        ))}\n    </HStack>\n  );\n};\n\nconst KeyValueValidations = ({ validations }: { validations: Dictionary<unknown> }) => (\n  <>\n    {keys(validations)\n      .filter(key => Object.keys(validationFormatters).includes(key) && validations[key] !== void 0)\n      .map(key => {\n        const validation = validationFormatters[key](validations[key]);\n        if (validation) {\n          return <KeyValueValidation key={key} name={validation.name} values={validation.values} />;\n        } else {\n          return null;\n        }\n      })}\n  </>\n);\n\nconst KeyValueValidation = ({ name, values }: { name: string; values: string[] }) => {\n  return (\n    <HStack color=\"muted\" spacing={2} alignItems=\"baseline\">\n      <Text>{capitalize(name)}:</Text>\n\n      <Flex flexWrap flex={1} style={{ gap: 4 }}>\n        {uniq(values).map(value => (\n          <Value key={value} name={value} />\n        ))}\n      </Flex>\n    </HStack>\n  );\n};\n\nconst Value = ({ name }: { name: string }) => (\n  <Text px={1} bg=\"canvas-tint\" color=\"muted\" border rounded wordBreak=\"all\" maxW=\"full\">\n    {name}\n  </Text>\n);\n\nexport function validationCount(schemaNode: RegularNode) {\n  const validations = getValidationsFromSchema(schemaNode);\n  const validationKeys = keys(omit(validations, excludedValidations));\n  return uniq(validationKeys.map(key => ([...numberValidationNames].includes(key) ? 'number' : key))).length;\n}\n\nexport function getValidationsFromSchema(schemaNode: RegularNode) {\n  return {\n    ...(schemaNode.enum !== null\n      ? { enum: schemaNode.enum }\n      : // in case schemaNode is type: \"array\", check if its child have defined enum\n      schemaNode.primaryType === 'array' &&\n        schemaNode.children?.length === 1 &&\n        isRegularNode(schemaNode.children[0]) &&\n        schemaNode.children[0].enum !== null\n      ? { enum: schemaNode.children[0].enum }\n      : null),\n    ...('annotations' in schemaNode\n      ? {\n          ...(schemaNode.annotations.default !== void 0 ? { default: schemaNode.annotations.default } : null),\n          ...(schemaNode.annotations.examples ? { examples: schemaNode.annotations.examples } : null),\n        }\n      : null),\n    ...getFilteredValidations(schemaNode),\n  };\n}\n\nfunction getFilteredValidations(schemaNode: RegularNode) {\n  if (schemaNode.format !== null) {\n    return filterOutOasFormatValidations(schemaNode.format, schemaNode.validations);\n  }\n\n  return schemaNode.validations;\n}\n\nexport function getInternalSchemaError(schemaNode: SchemaNode, defaultErrorMessage?: string) {\n  let errorMessage: string | undefined;\n  const fragment: unknown = schemaNode.fragment;\n  if (typeof fragment === 'object' && fragment !== null) {\n    const fragmentErrorMessage = fragment['x-sl-error-message'];\n    if (typeof fragmentErrorMessage === 'string') {\n      errorMessage = fragmentErrorMessage ?? defaultErrorMessage;\n    } else {\n      const items: unknown = fragment['items'];\n      if (typeof items === 'object' && items !== null) {\n        const itemsErrorMessage = items['x-sl-error-message'];\n        if (typeof itemsErrorMessage === 'string') {\n          errorMessage = itemsErrorMessage ?? defaultErrorMessage;\n        }\n      }\n    }\n  }\n  return {\n    hasError: !!errorMessage,\n    error: errorMessage,\n  };\n}\n","import { SchemaNode } from '@stoplight/json-schema-tree';\nimport { Box, SpaceVals } from '@stoplight/mosaic';\nimport * as React from 'react';\n\nimport { NESTING_OFFSET } from '../../consts';\nimport { useJSVOptionsContext } from '../../contexts';\nimport type { ChangeType } from '../../types';\nimport { SchemaRow, SchemaRowProps } from '../SchemaRow';\n\ntype ChildStackProps = {\n  schemaNode: SchemaNode;\n  childNodes: readonly SchemaNode[];\n  currentNestingLevel: number;\n  className?: string;\n  parentNodeId?: string;\n  RowComponent?: React.FC<SchemaRowProps>;\n  parentChangeType?: ChangeType;\n};\n\nexport const ChildStack = React.memo(\n  ({\n    childNodes,\n    currentNestingLevel,\n    className,\n    RowComponent = SchemaRow,\n    parentNodeId,\n    parentChangeType,\n  }: ChildStackProps) => {\n    const { renderRootTreeLines } = useJSVOptionsContext();\n    const rootLevel = renderRootTreeLines ? 0 : 1;\n    const isRootLevel = currentNestingLevel < rootLevel;\n\n    let ml: SpaceVals | undefined;\n    if (!isRootLevel) {\n      ml = currentNestingLevel === rootLevel ? 'px' : 7;\n    }\n\n    return (\n      <Box\n        className={className}\n        ml={ml}\n        fontSize=\"sm\"\n        borderL={isRootLevel ? undefined : true}\n        data-level={currentNestingLevel}\n      >\n        {childNodes.map((childNode: SchemaNode) => (\n          <RowComponent\n            key={childNode.id}\n            schemaNode={childNode}\n            nestingLevel={currentNestingLevel + 1}\n            pl={isRootLevel ? undefined : NESTING_OFFSET}\n            parentNodeId={parentNodeId}\n            parentChangeType={parentChangeType}\n          />\n        ))}\n      </Box>\n    );\n  },\n);\n","import { Box } from '@stoplight/mosaic';\nimport { Dictionary } from '@stoplight/types';\nimport * as React from 'react';\n\nimport { useJSVOptionsContext } from '../../contexts';\n\nexport interface IProperties {\n  required: boolean;\n  deprecated: boolean;\n  validations: Dictionary<unknown>;\n}\n\nexport const useHasProperties = ({ required, deprecated, validations: { readOnly, writeOnly } }: IProperties) => {\n  const { viewMode } = useJSVOptionsContext();\n\n  const showVisibilityValidations = viewMode === 'standalone' && !!readOnly !== !!writeOnly;\n\n  return deprecated || showVisibilityValidations || required;\n};\n\nexport const Properties: React.FunctionComponent<IProperties> = ({\n  required,\n  deprecated,\n  validations: { readOnly, writeOnly },\n}) => {\n  const { viewMode } = useJSVOptionsContext();\n\n  // Show readOnly writeOnly validations only in standalone mode and only if just one of them is present\n  const showVisibilityValidations = viewMode === 'standalone' && !!readOnly !== !!writeOnly;\n  const visibility = showVisibilityValidations ? (\n    readOnly ? (\n      <Box as=\"span\" ml={2} color=\"muted\">\n        read-only\n      </Box>\n    ) : (\n      <Box as=\"span\" ml={2} color=\"muted\">\n        write-only\n      </Box>\n    )\n  ) : null;\n\n  return (\n    <>\n      {deprecated ? (\n        <Box as=\"span\" ml={2} color=\"warning\">\n          deprecated\n        </Box>\n      ) : null}\n      {visibility}\n      {required && (\n        <Box as=\"span\" ml={2} color=\"warning\">\n          required\n        </Box>\n      )}\n    </>\n  );\n};\n","import { extractPointerFromRef, pointerToPath } from '@stoplight/json';\nimport { isReferenceNode, isRegularNode, SchemaNode } from '@stoplight/json-schema-tree';\nimport last from 'lodash/last.js';\nimport * as React from 'react';\n\nimport { isComplexArray, isNonEmptyParentNode } from '../../tree';\nimport { printName } from '../../utils';\n\ntype Choice = {\n  title: string;\n  type: SchemaNode;\n};\n\nfunction calculateChoiceTitle(node: SchemaNode, isPlural: boolean): string {\n  const primitiveSuffix = isPlural ? 's' : '';\n  if (isRegularNode(node)) {\n    const realName = printName(node, { shouldUseRefNameFallback: true });\n    if (realName) {\n      return realName;\n    }\n    return node.primaryType !== null ? node.primaryType + primitiveSuffix : 'any';\n  }\n  if (isReferenceNode(node)) {\n    if (node.value) {\n      const value = extractPointerFromRef(node.value);\n      const lastPiece = !node.error && value ? last(pointerToPath(value)) : null;\n      if (typeof lastPiece === 'string') {\n        return lastPiece.split('.')[0];\n      }\n    }\n    return '$ref' + primitiveSuffix;\n  }\n\n  return 'any';\n}\n\nfunction makeChoice(node: SchemaNode): Choice {\n  return {\n    type: node,\n    title: calculateChoiceTitle(node, false),\n  };\n}\n\nfunction makeArrayChoice(node: SchemaNode, combiner?: string): Choice {\n  const itemTitle = calculateChoiceTitle(node, true);\n  const title = itemTitle !== 'any' ? `array ${combiner ? `(${combiner})` : null} [${itemTitle}]` : 'array';\n  return {\n    type: node,\n    title,\n  };\n}\n\n/**\n * Calculates type choices for a given node.\n *\n * Usually a node has one choice - only one possible type -, itself.\n * If a node is an oneOf or anyOf combiner, the possible types are the sub-types of the combiner.\n */\nexport const useChoices = (schemaNode: SchemaNode) => {\n  const choices: Choice[] = React.useMemo(() => {\n    // handle flattening of arrays that contain oneOfs, same logic as below\n    if (\n      isComplexArray(schemaNode) &&\n      isNonEmptyParentNode(schemaNode.children[0]) &&\n      shouldShowChildSelector(schemaNode.children[0])\n    ) {\n      return schemaNode.children[0].children.map(child =>\n        makeArrayChoice(child, schemaNode.children[0].combiners?.[0]),\n      );\n    }\n\n    // if current node is a combiner, offer its children\n    if (isNonEmptyParentNode(schemaNode) && shouldShowChildSelector(schemaNode)) {\n      return schemaNode.children.map(makeChoice);\n    }\n    // regular node, single choice - itself\n    return [makeChoice(schemaNode)];\n  }, [schemaNode]);\n\n  const defaultChoice = choices[0];\n\n  const [selectedChoice, setSelectedChoice] = React.useState<Choice | undefined>(defaultChoice);\n\n  React.useEffect(() => {\n    setSelectedChoice(defaultChoice);\n  }, [defaultChoice]);\n\n  const actualSelectedChoice = selectedChoice && choices.includes(selectedChoice) ? selectedChoice : defaultChoice;\n\n  return { selectedChoice: actualSelectedChoice, setSelectedChoice, choices };\n};\n\nconst shouldShowChildSelector = (schemaNode: SchemaNode) =>\n  isNonEmptyParentNode(schemaNode) && ['anyOf', 'oneOf'].includes(schemaNode.combiners?.[0] ?? '');\n","import {\n  isMirroredNode,\n  isReferenceNode,\n  isRegularNode,\n  ReferenceNode,\n  SchemaNode,\n  SchemaNodeKind,\n} from '@stoplight/json-schema-tree';\nimport { BackgroundColorVals, Box, BoxProps, Flex, Icon, Select, SpaceVals, VStack } from '@stoplight/mosaic';\nimport { Atom } from 'jotai';\nimport { useAtomValue, useUpdateAtom } from 'jotai/utils';\nimport last from 'lodash/last.js';\nimport * as React from 'react';\n\nimport { COMBINER_NAME_MAP } from '../../consts';\nimport { useJSVOptionsContext } from '../../contexts';\nimport { getNodeId, getOriginalNodeId } from '../../hash';\nimport { calculateChildrenToShow, isFlattenableNode, isPropertyRequired } from '../../tree';\nimport { ChangeType, NodeHasChangedFn } from '../../types';\nimport { Caret, Description, getInternalSchemaError, getValidationsFromSchema, Types, Validations } from '../shared';\nimport { ChildStack } from '../shared/ChildStack';\nimport { Properties, useHasProperties } from '../shared/Properties';\nimport { hoveredNodeAtom, isNodeHoveredAtom } from './state';\nimport { useChoices } from './useChoices';\n\nexport interface SchemaRowProps {\n  schemaNode: SchemaNode;\n  nestingLevel: number;\n  pl?: SpaceVals;\n  parentNodeId?: string;\n  parentChangeType?: ChangeType;\n}\n\nconst ChangeTypeToColor: Record<ChangeType, BackgroundColorVals> = {\n  // @ts-expect-error\n  added: '#05B870',\n  // @ts-expect-error\n  modified: '#E9B703',\n  // @ts-expect-error\n  removed: '#F05151',\n};\n\nexport const SchemaRow: React.FunctionComponent<SchemaRowProps> = React.memo(\n  ({ schemaNode, nestingLevel, pl, parentNodeId, parentChangeType }) => {\n    const {\n      defaultExpandedDepth,\n      renderRowAddon,\n      onGoToRef,\n      hideExamples,\n      renderRootTreeLines,\n      nodeHasChanged,\n      viewMode,\n    } = useJSVOptionsContext();\n\n    const setHoveredNode = useUpdateAtom(hoveredNodeAtom);\n\n    const nodeId = getNodeId(schemaNode, parentNodeId);\n\n    // @ts-expect-error originalFragment does exist...\n    const originalNodeId = schemaNode.originalFragment?.$ref ? getOriginalNodeId(schemaNode, parentNodeId) : nodeId;\n    const mode = viewMode === 'standalone' ? undefined : viewMode;\n    const hasChanged = nodeHasChanged?.({ nodeId: originalNodeId, mode });\n\n    const [isExpanded, setExpanded] = React.useState<boolean>(\n      !isMirroredNode(schemaNode) && nestingLevel <= defaultExpandedDepth,\n    );\n\n    const { selectedChoice, setSelectedChoice, choices } = useChoices(schemaNode);\n    const typeToShow = selectedChoice.type;\n    const description = isRegularNode(typeToShow) ? typeToShow.annotations.description : null;\n\n    const refNode = React.useMemo<ReferenceNode | null>(() => {\n      if (isReferenceNode(schemaNode)) {\n        return schemaNode;\n      }\n\n      if (\n        isRegularNode(schemaNode) &&\n        (isFlattenableNode(schemaNode) ||\n          (schemaNode.primaryType === SchemaNodeKind.Array && schemaNode.children?.length === 1))\n      ) {\n        return (schemaNode.children?.find(isReferenceNode) as ReferenceNode | undefined) ?? null;\n      }\n\n      return null;\n    }, [schemaNode]);\n\n    const isBrokenRef = typeof refNode?.error === 'string';\n\n    const rootLevel = renderRootTreeLines ? 1 : 2;\n    const childNodes = React.useMemo(() => calculateChildrenToShow(typeToShow), [typeToShow]);\n    const combiner = isRegularNode(schemaNode) && schemaNode.combiners?.length ? schemaNode.combiners[0] : null;\n    const isCollapsible = childNodes.length > 0;\n    const isRootLevel = nestingLevel < rootLevel;\n\n    const required = isPropertyRequired(schemaNode);\n    const deprecated = isRegularNode(schemaNode) && schemaNode.deprecated;\n    const validations = isRegularNode(schemaNode) ? schemaNode.validations : {};\n    const hasProperties = useHasProperties({ required, deprecated, validations });\n\n    const internalSchemaError = getInternalSchemaError(schemaNode);\n\n    const annotationRootOffset = renderRootTreeLines ? 0 : 8;\n    let annotationLeftOffset = -20 - annotationRootOffset;\n    if (nestingLevel > 1) {\n      // annotationLeftOffset -= 27;\n      annotationLeftOffset =\n        -1 * 29 * Math.max(nestingLevel - 1, 1) - Math.min(nestingLevel, 2) * 2 - 16 - annotationRootOffset;\n\n      if (!renderRootTreeLines) {\n        annotationLeftOffset += 27;\n      }\n    }\n\n    if (parentChangeType === 'added' && hasChanged && hasChanged.type === 'removed') {\n      return null;\n    }\n\n    if (parentChangeType === 'removed' && hasChanged && hasChanged.type === 'added') {\n      return null;\n    }\n\n    return (\n      <>\n        <Flex\n          maxW=\"full\"\n          pl={pl}\n          py={2}\n          data-id={originalNodeId}\n          pos=\"relative\"\n          onMouseEnter={(e: any) => {\n            e.stopPropagation();\n            setHoveredNode(selectedChoice.type);\n          }}\n        >\n          {!isRootLevel && <Box borderT w={isCollapsible ? 1 : 3} ml={-3} mr={3} mt={2} />}\n\n          {parentChangeType !== 'added' && parentChangeType !== 'removed' ? (\n            <ChangeAnnotation change={hasChanged} style={{ left: annotationLeftOffset }} />\n          ) : null}\n\n          <VStack spacing={1} maxW=\"full\" flex={1} ml={isCollapsible && !isRootLevel ? 2 : undefined}>\n            <Flex\n              alignItems=\"center\"\n              maxW=\"full\"\n              onClick={isCollapsible ? () => setExpanded(!isExpanded) : undefined}\n              cursor={isCollapsible ? 'pointer' : undefined}\n            >\n              {isCollapsible ? <Caret isExpanded={isExpanded} /> : null}\n\n              <Flex alignItems=\"baseline\" fontSize=\"base\">\n                {schemaNode.subpath.length > 0 && shouldShowPropertyName(schemaNode) && (\n                  <Box mr={2} fontFamily=\"mono\" fontWeight=\"semibold\">\n                    {last(schemaNode.subpath)}\n                  </Box>\n                )}\n\n                {choices.length === 1 && <Types schemaNode={typeToShow} />}\n\n                {onGoToRef && isReferenceNode(schemaNode) && schemaNode.external ? (\n                  <Box\n                    as=\"a\"\n                    ml={2}\n                    cursor=\"pointer\"\n                    color=\"primary-light\"\n                    onClick={(e: React.MouseEvent) => {\n                      e.preventDefault();\n                      e.stopPropagation();\n                      onGoToRef(schemaNode);\n                    }}\n                  >\n                    (go to ref)\n                  </Box>\n                ) : null}\n\n                {schemaNode.subpath.length > 1 && schemaNode.subpath[0] === 'patternProperties' ? (\n                  <Box ml={2} color=\"muted\">\n                    (pattern property)\n                  </Box>\n                ) : null}\n\n                {choices.length > 1 && (\n                  <Select\n                    aria-label=\"Pick a type\"\n                    size=\"sm\"\n                    triggerTextPrefix={combiner ? `${COMBINER_NAME_MAP[combiner]}: ` : undefined}\n                    options={choices.map((choice, index) => ({\n                      value: String(index),\n                      label: choice.title,\n                    }))}\n                    value={\n                      String(choices.indexOf(selectedChoice))\n                      /* String to work around https://github.com/stoplightio/mosaic/issues/162 */\n                    }\n                    onChange={selectedIndex => setSelectedChoice(choices[selectedIndex as number])}\n                  />\n                )}\n              </Flex>\n\n              {hasProperties && <Divider atom={isNodeHoveredAtom(schemaNode)} />}\n\n              <Properties required={required} deprecated={deprecated} validations={validations} />\n            </Flex>\n\n            {typeof description === 'string' && description.length > 0 && <Description value={description} />}\n\n            <Validations\n              validations={isRegularNode(schemaNode) ? getValidationsFromSchema(schemaNode) : {}}\n              hideExamples={hideExamples}\n            />\n\n            {(isBrokenRef || internalSchemaError.hasError) && (\n              <Icon\n                title={refNode?.error! || internalSchemaError.error}\n                color=\"danger\"\n                icon={['fas', 'exclamation-triangle']}\n                size=\"sm\"\n              />\n            )}\n          </VStack>\n\n          {renderRowAddon ? <Box>{renderRowAddon({ schemaNode, nestingLevel })}</Box> : null}\n        </Flex>\n\n        {isCollapsible && isExpanded ? (\n          <ChildStack\n            schemaNode={schemaNode}\n            childNodes={childNodes}\n            currentNestingLevel={nestingLevel}\n            parentNodeId={nodeId}\n            parentChangeType={parentChangeType ? parentChangeType : hasChanged ? hasChanged?.type : undefined}\n          />\n        ) : null}\n      </>\n    );\n  },\n);\n\nconst ChangeAnnotation = ({ change, ...props }: { change?: ReturnType<NodeHasChangedFn> } & BoxProps<'div'>) => {\n  if (!change) return null;\n\n  const { style = {}, ...rest } = props;\n\n  // eslint-disable-next-line @typescript-eslint/prefer-nullish-coalescing\n  const selfAffected = change.selfAffected || change.type === 'added' || change.type === 'removed';\n\n  return (\n    <Box\n      w={1.5}\n      pos=\"absolute\"\n      pinY=\"px\"\n      bg={selfAffected ? ChangeTypeToColor[change.type] : undefined}\n      rounded\n      style={{\n        ...style,\n        borderWidth: 2,\n        borderColor: selfAffected ? 'transparent' : ChangeTypeToColor[change.type],\n      }}\n      {...rest}\n    >\n      <Box pos=\"absolute\" right={3} pinY fontSize=\"lg\" display=\"flex\" alignItems=\"center\">\n        {change.isBreaking ? (\n          <Box color=\"danger\">\n            <Icon icon={[selfAffected ? 'fas' : 'far', 'exclamation-circle']} />\n          </Box>\n        ) : null}\n      </Box>\n    </Box>\n  );\n};\n\nconst Divider = ({ atom }: { atom: Atom<boolean> }) => {\n  const isHovering = useAtomValue(atom);\n\n  return <Box bg={isHovering ? 'canvas-200' : undefined} h=\"px\" flex={1} mx={3} />;\n};\n\nfunction shouldShowPropertyName(schemaNode: SchemaNode) {\n  return (\n    schemaNode.subpath.length === 2 &&\n    (schemaNode.subpath[0] === 'properties' || schemaNode.subpath[0] === 'patternProperties')\n  );\n}\n","import { RefObject, useEffect, useState } from 'react';\n\nexport const useIsOnScreen = (ref: RefObject<HTMLElement>) => {\n  const [isOnScreen, setIsOnScreen] = useState(true);\n\n  useEffect(() => {\n    let observer: IntersectionObserver | null = null;\n\n    if (ref.current) {\n      const scrollParent = getScrollParent(ref.current);\n      const observer = new IntersectionObserver(\n        ([entry]) => {\n          setIsOnScreen(entry.isIntersecting);\n        },\n        {\n          root: scrollParent === window ? undefined : (scrollParent as HTMLElement),\n          rootMargin: '20px 0px 0px 0px',\n        },\n      );\n\n      observer.observe(ref.current);\n    }\n\n    return () => {\n      observer?.disconnect();\n    };\n  }, [ref]);\n\n  return isOnScreen;\n};\n\nfunction getScrollParent(node: HTMLElement | null): HTMLElement | typeof window | null {\n  if (node == null) {\n    return null;\n  }\n\n  if (node.scrollHeight > node.clientHeight && node.clientHeight > 0) {\n    return node.tagName === 'HTML' ? window : node;\n  } else {\n    return getScrollParent(node.parentElement);\n  }\n}\n","import { isRegularNode, RegularNode } from '@stoplight/json-schema-tree';\nimport { Box, Flex, HStack, Icon, Menu, Pressable } from '@stoplight/mosaic';\nimport { useUpdateAtom } from 'jotai/utils';\nimport * as React from 'react';\n\nimport { COMBINER_NAME_MAP } from '../../consts';\nimport { useIsOnScreen } from '../../hooks/useIsOnScreen';\nimport { calculateChildrenToShow, isComplexArray } from '../../tree';\nimport { showPathCrumbsAtom } from '../PathCrumbs/state';\nimport { Description } from '../shared';\nimport { ChildStack } from '../shared/ChildStack';\nimport { getInternalSchemaError } from '../shared/Validations';\nimport { SchemaRow, SchemaRowProps } from './SchemaRow';\nimport { useChoices } from './useChoices';\n\nexport const TopLevelSchemaRow = ({ schemaNode }: Pick<SchemaRowProps, 'schemaNode'>) => {\n  const { selectedChoice, setSelectedChoice, choices } = useChoices(schemaNode);\n  const childNodes = React.useMemo(() => calculateChildrenToShow(selectedChoice.type), [selectedChoice.type]);\n  const nestingLevel = 0;\n\n  const nodeId = schemaNode.fragment?.['x-stoplight']?.id;\n\n  const internalSchemaError = getInternalSchemaError(schemaNode);\n\n  // regular objects are flattened at the top level\n  if (isRegularNode(schemaNode) && isPureObjectNode(schemaNode)) {\n    return (\n      <>\n        <ScrollCheck />\n        <Description value={schemaNode.annotations.description} />\n        <ChildStack\n          schemaNode={schemaNode}\n          childNodes={childNodes}\n          currentNestingLevel={nestingLevel}\n          parentNodeId={nodeId}\n        />\n        {internalSchemaError.hasError && (\n          <Icon title={internalSchemaError.error} color=\"danger\" icon={['fas', 'exclamation-triangle']} size=\"sm\" />\n        )}\n      </>\n    );\n  }\n\n  if (isRegularNode(schemaNode) && choices.length > 1) {\n    const combiner = isRegularNode(schemaNode) && schemaNode.combiners?.length ? schemaNode.combiners[0] : null;\n\n    return (\n      <>\n        <ScrollCheck />\n        <Description value={schemaNode.annotations.description} />\n\n        <HStack spacing={3} pb={4}>\n          <Menu\n            aria-label=\"Pick a type\"\n            closeOnPress\n            placement=\"bottom left\"\n            items={choices.map((choice, index) => ({\n              id: index,\n              title: choice.title,\n              onPress: () => setSelectedChoice(choice),\n            }))}\n            renderTrigger={props => (\n              <Pressable {...props}>\n                <Flex fontFamily=\"mono\" fontWeight=\"semibold\" cursor=\"pointer\" fontSize=\"base\">\n                  {selectedChoice.title}\n                  <Box ml={1}>\n                    <Icon icon={['fas', 'caret-down']} />\n                  </Box>\n                </Flex>\n              </Pressable>\n            )}\n          />\n\n          {combiner !== null ? (\n            <Flex alignItems=\"center\" color=\"muted\" fontSize=\"base\">\n              {`(${COMBINER_NAME_MAP[combiner]})`}\n            </Flex>\n          ) : null}\n        </HStack>\n\n        {childNodes.length > 0 ? (\n          <ChildStack\n            schemaNode={schemaNode}\n            childNodes={childNodes}\n            currentNestingLevel={nestingLevel}\n            parentNodeId={nodeId}\n          />\n        ) : null}\n      </>\n    );\n  }\n\n  if (isComplexArray(schemaNode) && isPureObjectNode(schemaNode.children[0])) {\n    return (\n      <>\n        <ScrollCheck />\n        <Description value={schemaNode.annotations.description} />\n\n        <Box fontFamily=\"mono\" fontWeight=\"semibold\" fontSize=\"base\" pb={4}>\n          array of:\n        </Box>\n\n        {childNodes.length > 0 ? (\n          <ChildStack\n            schemaNode={schemaNode}\n            childNodes={childNodes}\n            currentNestingLevel={nestingLevel}\n            parentNodeId={nodeId}\n          />\n        ) : null}\n      </>\n    );\n  }\n\n  return (\n    <>\n      <ScrollCheck />\n      <SchemaRow schemaNode={schemaNode} nestingLevel={nestingLevel} />\n    </>\n  );\n};\n\nfunction ScrollCheck() {\n  const elementRef = React.useRef<HTMLDivElement>(null);\n\n  const isOnScreen = useIsOnScreen(elementRef);\n  const setShowPathCrumbs = useUpdateAtom(showPathCrumbsAtom);\n  React.useEffect(() => {\n    setShowPathCrumbs(!isOnScreen);\n  }, [isOnScreen, setShowPathCrumbs]);\n\n  return <div ref={elementRef} />;\n}\n\nfunction isPureObjectNode(schemaNode: RegularNode) {\n  return schemaNode.primaryType === 'object' && schemaNode.types?.length === 1;\n}\n","import {\n  isRegularNode,\n  RootNode,\n  SchemaNode,\n  SchemaTree as JsonSchemaTree,\n  SchemaTreeRefDereferenceFn,\n} from '@stoplight/json-schema-tree';\nimport { Box, Provider as MosaicProvider } from '@stoplight/mosaic';\nimport { ErrorBoundaryForwardedProps, FallbackProps, withErrorBoundary } from '@stoplight/react-error-boundary';\nimport cn from 'classnames';\nimport { Provider } from 'jotai';\nimport { useUpdateAtom } from 'jotai/utils';\nimport * as React from 'react';\n\nimport { JSVOptions, JSVOptionsContextProvider } from '../contexts';\nimport type { DiffRenderer, JSONSchema } from '../types';\nimport { PathCrumbs } from './PathCrumbs';\nimport { TopLevelSchemaRow } from './SchemaRow';\nimport { hoveredNodeAtom } from './SchemaRow/state';\n\nexport type JsonSchemaProps = Partial<JSVOptions> & {\n  schema: JSONSchema;\n  emptyText?: string;\n  className?: string;\n  resolveRef?: SchemaTreeRefDereferenceFn;\n  onTreePopulated?: (props: { rootNode: RootNode; nodeCount: number }) => void;\n  maxHeight?: number;\n  parentCrumbs?: string[];\n} & DiffRenderer;\n\nconst JsonSchemaViewerComponent = ({\n  viewMode = 'standalone',\n  defaultExpandedDepth = 1,\n  onGoToRef,\n  renderRowAddon,\n  hideExamples,\n  renderRootTreeLines,\n  disableCrumbs,\n  nodeHasChanged,\n  ...rest\n}: JsonSchemaProps & ErrorBoundaryForwardedProps) => {\n  const options = React.useMemo(\n    () => ({\n      defaultExpandedDepth,\n      viewMode,\n      onGoToRef,\n      renderRowAddon,\n      hideExamples,\n      renderRootTreeLines,\n      disableCrumbs,\n      nodeHasChanged,\n    }),\n    [\n      defaultExpandedDepth,\n      viewMode,\n      onGoToRef,\n      renderRowAddon,\n      hideExamples,\n      renderRootTreeLines,\n      disableCrumbs,\n      nodeHasChanged,\n    ],\n  );\n\n  return (\n    <MosaicProvider>\n      <JSVOptionsContextProvider value={options}>\n        <Provider>\n          <JsonSchemaViewerInner viewMode={viewMode} {...rest} />\n        </Provider>\n      </JSVOptionsContextProvider>\n    </MosaicProvider>\n  );\n};\n\nconst JsonSchemaViewerInner = ({\n  schema,\n  viewMode,\n  className,\n  resolveRef,\n  emptyText = 'No schema defined',\n  onTreePopulated,\n  maxHeight,\n  parentCrumbs,\n}: Pick<\n  JsonSchemaProps,\n  'schema' | 'viewMode' | 'className' | 'resolveRef' | 'emptyText' | 'onTreePopulated' | 'maxHeight' | 'parentCrumbs'\n>) => {\n  const setHoveredNode = useUpdateAtom(hoveredNodeAtom);\n  const onMouseLeave = React.useCallback(() => {\n    setHoveredNode(null);\n  }, [setHoveredNode]);\n\n  const { jsonSchemaTreeRoot, nodeCount } = React.useMemo(() => {\n    const jsonSchemaTree = new JsonSchemaTree(schema, {\n      mergeAllOf: true,\n      refResolver: resolveRef,\n    });\n\n    let nodeCount = 0;\n    const shouldNodeBeIncluded = (node: SchemaNode) => {\n      if (!isRegularNode(node)) return true;\n\n      const { validations } = node;\n\n      if (!!validations.writeOnly === !!validations.readOnly) {\n        return true;\n      }\n\n      return !((viewMode === 'read' && !!validations.writeOnly) || (viewMode === 'write' && !!validations.readOnly));\n    };\n\n    jsonSchemaTree.walker.hookInto('filter', node => {\n      if (shouldNodeBeIncluded(node)) {\n        nodeCount++;\n        return true;\n      }\n      return false;\n    });\n    jsonSchemaTree.populate();\n\n    return {\n      jsonSchemaTreeRoot: jsonSchemaTree.root,\n      nodeCount,\n    };\n  }, [schema, resolveRef, viewMode]);\n\n  React.useEffect(() => {\n    onTreePopulated?.({\n      rootNode: jsonSchemaTreeRoot,\n      nodeCount: nodeCount,\n    });\n  }, [jsonSchemaTreeRoot, onTreePopulated, nodeCount]);\n\n  const isEmpty = React.useMemo(\n    () => jsonSchemaTreeRoot.children.every(node => !isRegularNode(node) || node.unknown),\n    [jsonSchemaTreeRoot],\n  );\n  if (isEmpty) {\n    return (\n      <Box className={cn(className, 'JsonSchemaViewer')} fontSize=\"sm\">\n        {emptyText}\n      </Box>\n    );\n  }\n\n  return (\n    <Box\n      className={cn('JsonSchemaViewer', className)}\n      pos={maxHeight ? 'relative' : undefined}\n      overflowY={maxHeight ? 'auto' : undefined}\n      onMouseLeave={onMouseLeave}\n      style={{ maxHeight }}\n    >\n      <PathCrumbs parentCrumbs={parentCrumbs} />\n      <TopLevelSchemaRow schemaNode={jsonSchemaTreeRoot.children[0]} />\n    </Box>\n  );\n};\n\nconst JsonSchemaFallbackComponent = ({ error }: FallbackProps) => {\n  return (\n    <Box p={4}>\n      <Box as=\"b\" color=\"danger\">\n        Error\n      </Box>\n      {error !== null ? `: ${error.message}` : null}\n    </Box>\n  );\n};\n\nexport const JsonSchemaViewer = withErrorBoundary<JsonSchemaProps>(JsonSchemaViewerComponent, {\n  FallbackComponent: JsonSchemaFallbackComponent,\n  recoverableProps: ['schema'],\n});\n"],"names":["React","atom","atomFamily","isRootNode","isRegularNode","useAtom","Box","HStack","SchemaCombinerName","fnv","SchemaNodeKind","isReferenceNode","Flex","Icon","MarkdownViewer","Text","Link","upperFirst","getLastPathSegment","pick","omit","keys","capitalize","uniq","extractPointerFromRef","last","pointerToPath","useUpdateAtom","isMirroredNode","VStack","Select","useAtomValue","useState","useEffect","Menu","Pressable","MosaicProvider","Provider","jsonSchemaTree","JsonSchemaTree","cn","withErrorBoundary"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAeA,MAAM,iBAAiB,GAAGA,gBAAK,CAAC,aAAa,CAAa;IACxD,oBAAoB,EAAE,CAAC;IACvB,QAAQ,EAAE,YAAY;IACtB,YAAY,EAAE,KAAK;CACpB,CAAC,CAAC;AAEI,MAAM,oBAAoB,GAAG,MAAMA,gBAAK,CAAC,UAAU,CAAC,iBAAiB,CAAC,CAAC;AAEvE,MAAM,yBAAyB,GAAG,iBAAiB,CAAC,QAAQ;;ACnB5D,MAAM,eAAe,GAAGC,UAAI,CAAoB,IAAI,CAAC,CAAC;AACtD,MAAM,iBAAiB,GAAGC,gBAAU,CAAC,CAAC,IAAgB,KAAKD,UAAI,CAAC,GAAG,IAAI,IAAI,KAAK,GAAG,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC;AACxEC,gBAAU,CAAC,CAAC,MAAkB,KAClED,UAAI,CAAC,GAAG;IACN,MAAM,WAAW,GAAG,GAAG,CAAC,eAAe,CAAC,CAAC;IAEzC,IAAI,CAAC,WAAW,IAAI,WAAW,KAAK,MAAM;QAAE,OAAO,KAAK,CAAC;IAEzD,OAAO,WAAW,CAAC,MAAM,KAAK,MAAM,CAAC;AACvC,CAAC,CAAC;;ACRG,MAAM,kBAAkB,GAAGA,UAAI,CAAU,KAAK,CAAC,CAAC;AAEhD,MAAM,cAAc,GAAGA,UAAI,CAAC,GAAG;IACpC,MAAM,IAAI,GAAG,GAAG,CAAC,eAAe,CAAC,CAAC;IAElC,IAAI,CAAC,IAAI;QAAE,OAAO,EAAE,CAAC;IAErB,OAAO,wBAAwB,CAAC,IAAkB,CAAC,CAAC;AACtD,CAAC,CAAC,CAAC;AAEH,SAAS,wBAAwB,CAAC,IAAgB;IAChD,MAAM,UAAU,GAAa,EAAE,CAAC;IAEhC,IAAI,WAAW,GAAsB,IAAI,CAAC;IAC1C,OAAO,WAAW,IAAI,CAACE,yBAAU,CAAC,WAAW,CAAC,EAAE;QAC9C,IAAIC,4BAAa,CAAC,WAAW,CAAC,EAAE;YAC9B,MAAM,QAAQ,GAAG,WAAW,CAAC,OAAO,CAAC,WAAW,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;YAErE,IAAI,WAAW,CAAC,WAAW,KAAK,OAAO,EAAE;gBACvC,MAAM,GAAG,GAAG,GAAG,QAAQ,IAAI,EAAE,IAAI,CAAC;gBAClC,IAAI,UAAU,CAAC,UAAU,CAAC,MAAM,GAAG,CAAC,CAAC,EAAE;oBACrC,UAAU,CAAC,UAAU,CAAC,MAAM,GAAG,CAAC,CAAC,GAAG,GAAG,CAAC;iBACzC;qBAAM;oBACL,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;iBACtB;aACF;iBAAM,IACL,QAAQ;iBACP,WAAW,CAAC,OAAO,CAAC,MAAM,KAAK,CAAC,IAAI,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC,QAAQ,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,EACnG;gBACA,UAAU,CAAC,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,WAAW,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;aACtE;SACF;QAED,WAAW,GAAG,WAAW,CAAC,MAAM,CAAC;KAClC;IAED,OAAO,UAAU,CAAC,OAAO,EAAE,CAAC;AAC9B;;ACnCO,MAAM,UAAU,GAAG,CAAC,EAAE,YAAY,GAAG,EAAE,EAA+B;IAC3E,MAAM,CAAC,cAAc,CAAC,GAAGC,aAAO,CAAC,kBAAkB,CAAC,CAAC;IACrD,MAAM,CAAC,UAAU,CAAC,GAAGA,aAAO,CAAC,cAAc,CAAC,CAAC;IAC7C,MAAM,EAAE,aAAa,EAAE,GAAG,oBAAoB,EAAE,CAAC;IAEjD,IAAI,aAAa,EAAE;QACjB,OAAO,IAAI,CAAC;KACb;IAED,MAAM,gBAAgB,GAAyB,EAAE,CAAC;IAClD,YAAY,CAAC,OAAO,CAAC,CAAC,KAAK,EAAE,CAAC;QAC5B,gBAAgB,CAAC,IAAI,CAACL,+BAACM,UAAG,IAAC,GAAG,EAAE,CAAC,IAAG,KAAK,CAAO,CAAC,CAAC;KACnD,CAAC,CAAC;IAEH,MAAM,cAAc,GAAyB,EAAE,CAAC;IAChD,UAAU,CAAC,OAAO,CAAC,CAAC,KAAK,EAAE,CAAC;QAC1B,IAAI,UAAU,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE;YACrB,cAAc,CAAC,IAAI,CAACN,+BAACM,UAAG,IAAC,GAAG,EAAE,CAAC,IAAG,KAAK,CAAO,CAAC,CAAC;SACjD;aAAM;YACL,cAAc,CAAC,IAAI,CACjBN,+BAACM,UAAG,IAAC,GAAG,EAAE,CAAC,EAAE,KAAK,EAAC,MAAM,EAAC,UAAU,EAAC,UAAU,IAC5C,KAAK,CACF,CACP,CAAC;SACH;KACF,CAAC,CAAC;IAGH,IAAI,CAAC,cAAc,KAAK,CAAC,gBAAgB,CAAC,MAAM,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE;QAC3E,OAAO,IAAI,CAAC;KACb;IAED,QACEN,+BAACO,aAAM,IACL,OAAO,EAAE,CAAC,EACV,OAAO,EAAEP,+BAACM,UAAG,YAAQ,EACrB,CAAC,EAAC,IAAI,EAEN,EAAE,EAAE,CAAC,CAAC,EACN,OAAO,QACP,GAAG,EAAC,QAAQ,EACZ,GAAG,EAAE,CAAC,EACN,UAAU,EAAC,MAAM,EACjB,QAAQ,EAAC,IAAI,EACb,UAAU,EAAC,MAAM,EACjB,MAAM,EAAE,EAAE,EACV,EAAE,EAAC,aAAa,EAChB,EAAE,EAAC,IAAI,EACP,KAAK,EAAC,OAAO,EACb,UAAU,EAAC,QAAQ;QAElB,gBAAgB;QAChB,cAAc,CAAC,MAAM,IAAIN,+BAACO,aAAM,IAAC,OAAO,EAAEP,+BAACM,UAAG,IAAC,UAAU,EAAC,MAAM,QAAQ,IAAG,cAAc,CAAU,CAC7F,EACT;AACJ,CAAC;;CC1DsF;IACrF,CAACE,iCAAkB,CAAC,KAAK,GAAG,KAAK;IACjC,CAACA,iCAAkB,CAAC,KAAK,GAAG,QAAQ;IACpC,CAACA,iCAAkB,CAAC,KAAK,GAAG,IAAI;GAChC;AAEK,MAAM,kCAAkC,GAAG;IAEhD,MAAM,EAAE,CAAC,MAAM,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,QAAQ,CAAC;IACrD,IAAI,OAAO;QACT,OAAO,IAAI,CAAC,MAAM,CAAC;KACpB;CACF,CAAC;AAEK,MAAM,cAAc,GAAc,CAAC,CAAC;AAEpC,MAAM,eAAe,GAAG,IAAI,CAAC;AAE7B,MAAM,iBAAiB,GAA2C;IACvE,KAAK,EAAE,QAAQ;IACf,KAAK,EAAE,QAAQ;IACf,KAAK,EAAE,QAAQ;CAChB;;ACrBD,IAAI,YAAY,GAAG,KAAK,CAAC;AAMlB,MAAM,IAAI,GAAG,CAAC,KAAa,EAAE,cAAuB,YAAY;IAGrE,OAAO,WAAW,GAAG,KAAK,GAAGC,cAAG,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;AACtD,CAAC,CAAC;AAEK,MAAM,SAAS,GAAG,CAAC,IAAgB,EAAE,QAAiB;;IAC3D,MAAM,MAAM,GAAG,MAAA,MAAA,IAAI,CAAC,QAAQ,0CAAG,aAAa,CAAC,0CAAE,EAAE,CAAC;IAClD,IAAI,MAAM;QAAE,OAAO,MAAM,CAAC;IAE1B,MAAM,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;IAE5C,OAAO,IAAI,CAAC,CAAC,iBAAiB,EAAE,QAAQ,EAAE,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;AACpE,CAAC,CAAC;AAEK,MAAM,iBAAiB,GAAG,CAAC,IAAgB,EAAE,QAAiB;;IAEnE,MAAM,MAAM,GAAG,MAAA,MAAA,IAAI,CAAC,gBAAgB,0CAAG,aAAa,CAAC,0CAAE,EAAE,CAAC;IAC1D,IAAI,MAAM;QAAE,OAAO,MAAM,CAAC;IAE1B,MAAM,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;IAE5C,OAAO,IAAI,CAAC,CAAC,iBAAiB,EAAE,QAAQ,EAAE,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;AACpE,CAAC;;SClCe,aAAa,CAAc,aAAgB;IACzD,OAAO,aAAa,KAAK,KAAK,CAAC,IAAI,aAAa,KAAK,IAAI,CAAC;AAC5D;;ACaO,MAAM,oBAAoB,GAAG,CAClC,IAAgB,KAGbL,4BAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC;SAExD,iBAAiB,CAAC,IAAgB;IAChD,IAAI,CAACA,4BAAa,CAAC,IAAI,CAAC;QAAE,OAAO,KAAK,CAAC;IAEvC,IAAI,IAAI,CAAC,WAAW,KAAKM,6BAAc,CAAC,KAAK,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,IAAI,CAAC,QAAQ,CAAC,MAAM,KAAK,CAAC,EAAE;QAC5G,OAAO,KAAK,CAAC;KACd;IAED,QACE,IAAI,CAAC,QAAQ,CAAC,MAAM,KAAK,CAAC;SACzBN,4BAAa,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,KAAKO,8BAAe,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,KAAK,KAAK,IAAI,CAAC,CAAC,EAC3G;AACJ,CAAC;SAEe,gBAAgB,CAAC,IAAgB;IAC/C,OAAO,iBAAiB,CAAC,IAAI,CAAC,IAAIP,4BAAa,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC;AAC/F,CAAC;SAEe,cAAc,CAAC,IAAgB;IAC7C,OAAO,iBAAiB,CAAC,IAAI,CAAC,IAAIA,4BAAa,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC;AAChG,CAAC;SAMe,uBAAuB,CAAC,IAAgB;;IACtD,IAAI,CAACA,4BAAa,CAAC,IAAI,CAAC,IAAI,gBAAgB,CAAC,IAAI,CAAC,EAAE;QAClD,OAAO,EAAE,CAAC;KACX;IACD,IAAI,cAAc,CAAC,IAAI,CAAC,EAAE;QAExB,OAAO,MAAA,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,QAAQ,mCAAI,EAAE,CAAC;KACxC;IACD,OAAO,MAAA,IAAI,CAAC,QAAQ,mCAAI,EAAE,CAAC;AAC7B,CAAC;SAEe,kBAAkB,CAAC,UAAsB;;IACvD,MAAM,EAAE,MAAM,EAAE,GAAG,UAAU,CAAC;IAC9B,IAAI,MAAM,KAAK,IAAI,IAAI,CAACA,4BAAa,CAAC,MAAM,CAAC,IAAI,UAAU,CAAC,OAAO,CAAC,MAAM,KAAK,CAAC,EAAE;QAChF,OAAO,KAAK,CAAC;KACd;IAED,OAAO,CAAC,EAAC,MAAA,MAAM,CAAC,QAAQ,0CAAE,QAAQ,CAAC,UAAU,CAAC,OAAO,CAAC,UAAU,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAA,CAAC;AACxF;;ACvDO,MAAM,KAAK,GAAoC,CAAC,EAAE,UAAU,EAAE,MACnEJ,+BAACY,WAAI,IAAC,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC,EAAE,KAAK,EAAC,OAAO,EAAC,IAAI,EAAC,QAAQ,EAAC,cAAc,EAAC,QAAQ;IAC5EZ,+BAACa,WAAI,IAAC,IAAI,EAAE,eAAe,EAAE,UAAU,QAAC,IAAI,EAAE,UAAU,GAAG,cAAc,GAAG,eAAe,GAAI,CAC1F,CACR;;ACTM,MAAM,WAAW,GAAgD,CAAC,EAAE,KAAK,EAAE;IAChF,MAAM,CAAC,OAAO,EAAE,UAAU,CAAC,GAAGb,gBAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;IAEpD,IAAI,OAAO,KAAK,KAAK,QAAQ,IAAI,KAAK,CAAC,IAAI,EAAE,CAAC,MAAM,KAAK,CAAC;QAAE,OAAO,IAAI,CAAC;IAExE,MAAM,UAAU,GAAG,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;IAEvC,IAAI,UAAU,CAAC,MAAM,IAAI,CAAC,IAAI,OAAO,EAAE;QACrC,QACEA,+BAACM,UAAG,IACF,EAAE,EAAEQ,6BAAc,EAClB,QAAQ,EAAE,KAAK,EACf,KAAK,EAAE;gBACL,QAAQ,EAAE,EAAE;aACb,GACD,EACF;KACH;IAED,MAAM,cAAc,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC;IAErC,QACEd,+BAACM,UAAG,IACF,EAAE,EAAEQ,6BAAc,EAClB,QAAQ,EAAE,cAAc,EACxB,YAAY,EAAE;YACZ,UAAU,EAAE;gBACV,CAAC,EAAE,CAAC,KAAU;oBACZ,QACEd,+BAACM,UAAG,IAAC,EAAE,EAAC,GAAG;wBACTN,+BAACe,WAAI,IAAC,EAAE,EAAE,CAAC,IAAG,KAAK,CAAC,QAAQ,CAAQ;wBACpCf,+BAACgB,WAAI,IAAC,MAAM,EAAC,SAAS,EAAC,OAAO,EAAE,MAAM,UAAU,CAAC,IAAI,CAAC,kBAE/C,CACH,EACN;iBACH;aACF;SACF,EACD,KAAK,EAAE;YACL,QAAQ,EAAE,EAAE;SACb,GACD,EACF;AACJ,CAAC;;ACzCM,MAAM,MAAM,GAAyC,CAAC,EAAE,MAAM,EAAE;IACrE,OAAOhB,+BAACM,UAAG,IAAC,EAAE,EAAC,MAAM,EAAC,KAAK,EAAC,OAAO,IAAE,IAAI,MAAM,GAAG,CAAO,CAAC;AAC5D,CAAC;;SCEe,SAAS,CACvB,UAAuB,EACvB,EAAE,wBAAwB,GAAG,KAAK,KAAuB,EAAE;;IAE3D,IACE,UAAU,CAAC,WAAW,KAAKI,6BAAc,CAAC,KAAK;QAC/C,CAAC,aAAa,CAAC,UAAU,CAAC,QAAQ,CAAC;QACnC,UAAU,CAAC,QAAQ,CAAC,MAAM,KAAK,CAAC,EAChC;QACA,OAAO,MAAA,UAAU,CAAC,KAAK,oCAAK,wBAAwB,GAAG,0BAA0B,CAAC,UAAU,CAAC,GAAG,SAAS,CAAC,CAAC;KAC5G;IAED,OAAO,cAAc,CAAC,UAAU,EAAE,EAAE,wBAAwB,EAAE,CAAC,CAAC;AAClE,CAAC;AAED,SAAS,cAAc,CACrB,UAAuB,EACvB,EAAE,wBAAwB,GAAG,KAAK,EAAoB;;IAEtD,IAAI,CAAC,aAAa,CAAC,UAAU,CAAC,QAAQ,CAAC,IAAI,UAAU,CAAC,QAAQ,CAAC,MAAM,KAAK,CAAC,EAAE;QAC3E,OAAO,MAAA,UAAU,CAAC,KAAK,oCAAK,wBAAwB,GAAG,0BAA0B,CAAC,UAAU,CAAC,GAAG,SAAS,CAAC,CAAC;KAC5G;IAED,IAAI,UAAU,CAAC,QAAQ,CAAC,MAAM,KAAK,CAAC,IAAIC,8BAAe,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,EAAE;QAC/E,OAAO,QAAQ,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,KAAK,KAAK,CAAC;KAClD;IAED,IAAI,gBAAgB,CAAC,UAAU,CAAC,EAAE;QAChC,MAAM,GAAG,GACP,MAAA,MAAA,UAAU,CAAC,QAAQ,0CAAE,MAAM,CAA0B,CAAC,WAAW,EAAE,KAAK;YACtE,IAAI,WAAW,KAAK,IAAI;gBAAE,OAAO,IAAI,CAAC;YAEtC,IAAI,CAACP,4BAAa,CAAC,KAAK,CAAC;gBAAE,OAAO,IAAI,CAAC;YAEvC,IAAI,KAAK,CAAC,KAAK,KAAK,IAAI,IAAI,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;gBAClD,KAAK,MAAM,IAAI,IAAI,KAAK,CAAC,KAAK,EAAE;oBAC9B,IAAI,WAAW,CAAC,QAAQ,CAAC,IAAI,CAAC;wBAAE,SAAS;oBACzC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;iBACxB;aACF;YAED,OAAO,WAAW,CAAC;SACpB,EAAE,EAAE,CAAC,mCAAI,IAAI,CAAC;QAEjB,OAAO,GAAG,KAAK,IAAI,IAAI,GAAG,CAAC,MAAM,GAAG,CAAC,GAAG,SAAS,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,GAAG,OAAO,CAAC;KAChF;IAED,IAAI,cAAc,CAAC,UAAU,CAAC,EAAE;QAC9B,MAAM,UAAU,GAAG,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;QAC1C,IAAI,UAAU,CAAC,KAAK,EAAE;YACpB,OAAO,SAAS,UAAU,CAAC,KAAK,GAAG,CAAC;SACrC;aAAM,IAAI,wBAAwB,IAAI,0BAA0B,CAAC,UAAU,CAAC,EAAE;YAC7E,OAAO,SAAS,0BAA0B,CAAC,UAAU,CAAC,GAAG,CAAC;SAC3D;aAAM,IAAI,UAAU,CAAC,WAAW,EAAE;YACjC,OAAO,SAAS,UAAU,CAAC,WAAW,GAAG,CAAC;SAC3C;aAAM,IAAI,MAAA,UAAU,CAAC,SAAS,0CAAE,MAAM,EAAE;YACvC,OAAO,SAAS,UAAU,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC;SACnD;QACD,OAAO,OAAO,CAAC;KAChB;IAED,OAAO,SAAS,CAAC;AACnB,CAAC;AAED,SAAS,0BAA0B,CAAC,IAAiB;IACnD,IAAI,OAAO,IAAI,CAAC,gBAAgB,CAAC,IAAI,KAAK,QAAQ,EAAE;QAClD,OAAOa,8BAAU,CAACC,uBAAkB,CAAC,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC,CAAC;KACnE;IACD,OAAO,SAAS,CAAC;AACnB;;AChEA,SAAS,gBAAgB,CAAC,IAAkD;IAC1E,OAAO,IAAI,KAAKR,6BAAc,CAAC,KAAK,IAAI,IAAI,KAAKA,6BAAc,CAAC,MAAM,IAAI,IAAI,KAAK,MAAM,CAAC;AAC5F,CAAC;AAED,SAAS,QAAQ,CAAC,UAAuB;IACvC,OAAO,CAAC,UAAU,CAAC,KAAK,EAAE,UAAU,CAAC,SAAS,CAAC,CAAC,MAAM,CACpD,CAAC,MAAM,EAAE,KAAK;QACZ,IAAI,KAAK,KAAK,IAAI,EAAE;YAClB,OAAO,MAAM,CAAC;SACf;QAED,MAAM,CAAC,IAAI,CAAC,GAAG,KAAK,CAAC,CAAC;QACtB,OAAO,MAAM,CAAC;KACf,EACD,EAAE,CACH,CAAC;AACJ,CAAC;AAED,SAAS,UAAU,CAAC,UAAuB;IACzC,MAAM,OAAO,GAA4C,EAAE,CAAC;IAE5D,IAAI,gBAAgB,CAAC,UAAU,CAAC,IAAI,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,MAAM,KAAK,IAAI,EAAE;QAC1E,OAAO,CAAC,KAAK,GAAG,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC;KAC/C;IAED,IAAI,UAAU,CAAC,MAAM,KAAK,IAAI,EAAE;QAC9B,OAAO,OAAO,CAAC;KAChB;IAED,MAAM,KAAK,GAAG,QAAQ,CAAC,UAAU,CAAC,CAAC;IAEnC,KAAK,MAAM,IAAI,IAAI,KAAK,EAAE;QACxB,IAAI,EAAE,IAAI,IAAI,kCAAkC,CAAC;YAAE,SAAS;QAE5D,IAAI,kCAAkC,CAAC,IAAI,CAAC,CAAC,QAAQ,CAAC,UAAU,CAAC,MAAM,CAAC,EAAE;YACxE,OAAO,CAAC,IAAI,CAAC,GAAG,UAAU,CAAC,MAAM,CAAC;YAClC,OAAO,OAAO,CAAC;SAChB;KACF;IAED,OAAO,CAAC,MAAM,GAAG,UAAU,CAAC,MAAM,CAAC;IACnC,OAAO,OAAO,CAAC;AACjB,CAAC;AAEM,MAAM,KAAK,GAAwD,CAAC,EAAE,UAAU,EAAE;;IACvF,IAAIC,8BAAe,CAAC,UAAU,CAAC,EAAE;QAC/B,QACEX,+BAACM,UAAG,IAAC,EAAE,EAAC,MAAM,EAAC,YAAY,EAAC,UAAU,IACnC,MAAA,UAAU,CAAC,KAAK,mCAAI,MAAM,CACvB,EACN;KACH;IAED,IAAI,CAACF,4BAAa,CAAC,UAAU,CAAC,EAAE;QAC9B,OAAO,IAAI,CAAC;KACb;IAED,MAAM,KAAK,GAAG,QAAQ,CAAC,UAAU,CAAC,CAAC;IACnC,MAAM,OAAO,GAAG,UAAU,CAAC,UAAU,CAAC,CAAC;IAEvC,IAAI,KAAK,CAAC,MAAM,KAAK,CAAC,EAAE;QACtB,OAAO,OAAO,CAAC,MAAM,KAAK,KAAK,CAAC,GAAGJ,+BAAC,MAAM,IAAC,MAAM,EAAE,OAAO,CAAC,MAAM,GAAI,GAAG,IAAI,CAAC;KAC9E;IAED,MAAM,QAAQ,GAAG,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,CAAC,EAAE,EAAE,MAAM,EAAE;;QAAK,QAClDA,+BAACA,gBAAK,CAAC,QAAQ,IAAC,GAAG,EAAE,IAAI;YACvBA,+BAACM,UAAG,IAAC,EAAE,EAAC,MAAM,EAAC,YAAY,EAAC,UAAU,EAAC,KAAK,EAAC,OAAO,IACjD,gBAAgB,CAAC,IAAI,CAAC,GAAG,MAAA,SAAS,CAAC,UAAU,CAAC,mCAAI,IAAI,GAAG,IAAI,CAC1D;YAEL,IAAI,IAAI,OAAO,GAAGN,+BAAC,MAAM,IAAC,MAAM,EAAE,OAAO,CAAC,IAAI,CAAC,GAAI,GAAG,IAAI;YAE1D,CAAC,GAAG,MAAM,GAAG,CAAC,KACbA,+BAACM,UAAG,IAAC,EAAE,EAAC,MAAM,EAAC,GAAG,EAAE,GAAG,CAAC,MAAM,EAAE,KAAK,EAAC,OAAO,IAC1C,MAAM,CACH,CACP,CACc,EAClB;KAAA,CAAC,CAAC;IAEH,OAAO,QAAQ,CAAC,MAAM,GAAG,CAAC,GAAGN,+BAACM,UAAG,IAAC,YAAY,EAAC,UAAU,IAAE,QAAQ,CAAO,GAAGN,gEAAG,QAAQ,CAAI,CAAC;AAC/F,CAAC,CAAC;AACF,KAAK,CAAC,WAAW,GAAG,wBAAwB;;AC9ErC,MAAM,qBAAqB,GAAG;IACnC,SAAS;IACT,SAAS;IACT,WAAW;IACX,WAAW;IACX,UAAU;IACV,UAAU;IACV,kBAAkB;IAClB,kBAAkB;CACnB,CAAC;AAEF,MAAM,sBAAsB,GAAG,CAAC,UAAU,CAAC,CAAC;AAE5C,MAAM,mBAAmB,GAAG,CAAC,kBAAkB,EAAE,kBAAkB,EAAE,UAAU,EAAE,WAAW,CAAC,CAAC;AAE9F,MAAM,0BAA0B,GAA+C;IAC7E,OAAO,EAAE,KAAK,IAAI,MAAM,KAAK,EAAE;IAC/B,gBAAgB,EAAE,KAAK,IAAI,KAAK,KAAK,EAAE;IACvC,QAAQ,EAAE,KAAK,IAAI,MAAM,KAAK,QAAQ;IACtC,SAAS,EAAE,KAAK,IAAI,MAAM,KAAK,aAAa;IAC5C,OAAO,EAAE,KAAK,IAAI,MAAM,KAAK,EAAE;IAC/B,gBAAgB,EAAE,KAAK,IAAI,KAAK,KAAK,EAAE;IACvC,QAAQ,EAAE,KAAK,IAAI,MAAM,KAAK,QAAQ;IACtC,SAAS,EAAE,KAAK,IAAI,MAAM,KAAK,aAAa;CAC7C,CAAC;AAEF,MAAM,qBAAqB,GAAG,CAAC,MAA2B,KAAK,CAAC,KAAc;IAC5E,OAAO,MAAM,IAAI,OAAO,KAAK,KAAK,QAAQ,GAAG,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;AAC7E,CAAC,CAAC;AAEF,MAAM,0BAA0B,GAC9B,CAAC,IAAY,EAAE,OAA+C,KAC9D,CAAC,KAA0B;IACzB,MAAM,MAAM,GAAG,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,KAAK,GAAG,CAAC,KAAK,CAAC,CAAC;IACtD,IAAI,MAAM,CAAC,MAAM,EAAE;QACjB,OAAO;YACL,IAAI,EAAE,CAAA,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,KAAK,IAAG,IAAI,GAAG,MAAM,CAAC,MAAM,GAAG,CAAC,GAAG,GAAG,IAAI,GAAG,GAAG,GAAG,IAAI,EAAE;YACxE,MAAM,EAAE,MAAM,CAAC,GAAG,CAAC,qBAAqB,CAAC,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,MAAM,CAAC,CAAC;SAC3D,CAAC;KACH;IACD,OAAO,IAAI,CAAC;AACd,CAAC,CAAC;AAEJ,MAAM,oBAAoB,GAAgE;IACxF,IAAI,EAAE,0BAA0B,CAAC,eAAe,EAAE,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC;IACnE,QAAQ,EAAE,0BAA0B,CAAC,SAAS,EAAE,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC;IACjE,UAAU,EAAE,0BAA0B,CAAC,aAAa,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC;IACtE,OAAO,EAAE,0BAA0B,CAAC,eAAe,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC;IACnF,OAAO,EAAE,0BAA0B,CAAC,SAAS,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC;IAC7E,KAAK,EAAE,0BAA0B,CAAC,OAAO,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC;CAC1E,CAAC;AAEF,MAAM,UAAU,GAAG;IACjB,KAAK,EAAE;QACL,OAAO,EAAE,CAAC,GAAG,CAAC,IAAI,EAAE;QACpB,OAAO,EAAE,CAAC,IAAI,EAAE,GAAG,CAAC;KACrB;IACD,KAAK,EAAE;QACL,OAAO,EAAE,CAAC,GAAG,CAAC,IAAI,EAAE;QACpB,OAAO,EAAE,CAAC,IAAI,EAAE,GAAG,CAAC;KACrB;IACD,KAAK,EAAE;QACL,OAAO,EAAE,CAAC,GAAG,CAAC,IAAI,GAAG;QACrB,OAAO,EAAE,CAAC,IAAI,GAAG,GAAG,CAAC;KACtB;IACD,MAAM,EAAE;QACN,OAAO,EAAE,CAAC,GAAG,MAAM,CAAC,SAAS;QAC7B,OAAO,EAAE,MAAM,CAAC,SAAS;KAC1B;IACD,IAAI,EAAE;QACJ,OAAO,EAAE,kBAAkB;KAC5B;CACF,CAAC;AAEF,SAAS,6BAA6B,CAAC,MAAc,EAAE,MAA2B;IAChF,IAAI,EAAE,MAAM,IAAI,UAAU,CAAC;QAAE,OAAO,MAAM,CAAC;IAE3C,MAAM,SAAS,qBAAQ,MAAM,CAAE,CAAC;IAEhC,KAAK,MAAM,CAAC,GAAG,EAAE,KAAK,CAAC,IAAI,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,EAAE;QAC7D,IAAI,KAAK,KAAK,SAAS,CAAC,GAAG,CAAC,EAAE;YAC5B,OAAO,SAAS,CAAC,GAAG,CAAC,CAAC;SACvB;KACF;IAED,OAAO,SAAS,CAAC;AACnB,CAAC;MAEY,WAAW,GAA0C,CAAC,EAAE,WAAW,EAAE,YAAY,EAAE;IAC9F,MAAM,iBAAiB,GAAGmB,wBAAI,CAAC,WAAW,EAAE,qBAAqB,CAAC,CAAC;IACnE,MAAM,mBAAmB,GAAGC,wBAAI,CAAC,WAAW,EAAE;QAC5C,GAAGC,wBAAI,CAAC,iBAAiB,CAAC;QAC1B,GAAG,mBAAmB;QACtB,IAAI,YAAY,GAAG,sBAAsB,GAAG,EAAE,CAAC;KAChD,CAAC,CAAC;IAEH,QACErB;QACEA,+BAAC,iBAAiB,IAAC,WAAW,EAAE,iBAAiB,GAAI;QACrDA,+BAAC,mBAAmB,IAAC,WAAW,EAAE,mBAAmB,GAAI,CACxD,EACH;AACJ,EAAE;AAEF,MAAM,iBAAiB,GAAG,CAAC,EACzB,WAAW,GAGZ;IACC,MAAM,OAAO,GAAG,MAAM,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;IAC5C,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE;QACnB,OAAO,IAAI,CAAC;KACb;IACD,QACEA,+BAACO,aAAM,IAAC,KAAK,EAAC,OAAO,EAAC,IAAI,EAAC,MAAM,EAAC,OAAO,EAAE,CAAC,IACzC,OAAO;SACL,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,KAAK,CAAC,KAAK,0BAA0B,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,CAAC;SAC7D,GAAG,CAAC,CAAC,KAAK,EAAE,CAAC,MACZP,+BAAC,KAAK,IAAC,GAAG,EAAE,CAAC,EAAE,IAAI,EAAE,KAAK,GAAI,CAC/B,CAAC,CACG,EACT;AACJ,CAAC,CAAC;AAEF,MAAM,mBAAmB,GAAG,CAAC,EAAE,WAAW,EAAwC,MAChFA,gEACGqB,wBAAI,CAAC,WAAW,CAAC;KACf,MAAM,CAAC,GAAG,IAAI,MAAM,CAAC,IAAI,CAAC,oBAAoB,CAAC,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,WAAW,CAAC,GAAG,CAAC,KAAK,KAAK,CAAC,CAAC;KAC7F,GAAG,CAAC,GAAG;IACN,MAAM,UAAU,GAAG,oBAAoB,CAAC,GAAG,CAAC,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC,CAAC;IAC/D,IAAI,UAAU,EAAE;QACd,OAAOrB,+BAAC,kBAAkB,IAAC,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,UAAU,CAAC,IAAI,EAAE,MAAM,EAAE,UAAU,CAAC,MAAM,GAAI,CAAC;KAC3F;SAAM;QACL,OAAO,IAAI,CAAC;KACb;AACH,CAAC,CAAC,CACH,CACJ,CAAC;AAEF,MAAM,kBAAkB,GAAG,CAAC,EAAE,IAAI,EAAE,MAAM,EAAsC;IAC9E,QACEA,+BAACO,aAAM,IAAC,KAAK,EAAC,OAAO,EAAC,OAAO,EAAE,CAAC,EAAE,UAAU,EAAC,UAAU;QACrDP,+BAACe,WAAI;YAAEO,8BAAU,CAAC,IAAI,CAAC;gBAAS;QAEhCtB,+BAACY,WAAI,IAAC,QAAQ,QAAC,IAAI,EAAE,CAAC,EAAE,KAAK,EAAE,EAAE,GAAG,EAAE,CAAC,EAAE,IACtCW,wBAAI,CAAC,MAAM,CAAC,CAAC,GAAG,CAAC,KAAK,KACrBvB,+BAAC,KAAK,IAAC,GAAG,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,GAAI,CACnC,CAAC,CACG,CACA,EACT;AACJ,CAAC,CAAC;AAEF,MAAM,KAAK,GAAG,CAAC,EAAE,IAAI,EAAoB,MACvCA,+BAACe,WAAI,IAAC,EAAE,EAAE,CAAC,EAAE,EAAE,EAAC,aAAa,EAAC,KAAK,EAAC,OAAO,EAAC,MAAM,QAAC,OAAO,QAAC,SAAS,EAAC,KAAK,EAAC,IAAI,EAAC,MAAM,IACnF,IAAI,CACA,CACR,CAAC;SAQc,wBAAwB,CAAC,UAAuB;;IAC9D,sDACM,UAAU,CAAC,IAAI,KAAK,IAAI;UACxB,EAAE,IAAI,EAAE,UAAU,CAAC,IAAI,EAAE;;YAE3B,UAAU,CAAC,WAAW,KAAK,OAAO;gBAChC,CAAA,MAAA,UAAU,CAAC,QAAQ,0CAAE,MAAM,MAAK,CAAC;gBACjCX,4BAAa,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;gBACrC,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,IAAI;kBACpC,EAAE,IAAI,EAAE,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE;kBACrC,IAAI,KACJ,aAAa,IAAI,UAAU;2CAErB,UAAU,CAAC,WAAW,CAAC,OAAO,KAAK,KAAK,CAAC,GAAG,EAAE,OAAO,EAAE,UAAU,CAAC,WAAW,CAAC,OAAO,EAAE,GAAG,IAAI,KAC9F,UAAU,CAAC,WAAW,CAAC,QAAQ,GAAG,EAAE,QAAQ,EAAE,UAAU,CAAC,WAAW,CAAC,QAAQ,EAAE,GAAG,IAAI,KAE5F,IAAI,IACL,sBAAsB,CAAC,UAAU,CAAC,EACrC;AACJ,CAAC;AAED,SAAS,sBAAsB,CAAC,UAAuB;IACrD,IAAI,UAAU,CAAC,MAAM,KAAK,IAAI,EAAE;QAC9B,OAAO,6BAA6B,CAAC,UAAU,CAAC,MAAM,EAAE,UAAU,CAAC,WAAW,CAAC,CAAC;KACjF;IAED,OAAO,UAAU,CAAC,WAAW,CAAC;AAChC,CAAC;SAEe,sBAAsB,CAAC,UAAsB,EAAE,mBAA4B;IACzF,IAAI,YAAgC,CAAC;IACrC,MAAM,QAAQ,GAAY,UAAU,CAAC,QAAQ,CAAC;IAC9C,IAAI,OAAO,QAAQ,KAAK,QAAQ,IAAI,QAAQ,KAAK,IAAI,EAAE;QACrD,MAAM,oBAAoB,GAAG,QAAQ,CAAC,oBAAoB,CAAC,CAAC;QAC5D,IAAI,OAAO,oBAAoB,KAAK,QAAQ,EAAE;YAC5C,YAAY,GAAG,oBAAoB,aAApB,oBAAoB,cAApB,oBAAoB,GAAI,mBAAmB,CAAC;SAC5D;aAAM;YACL,MAAM,KAAK,GAAY,QAAQ,CAAC,OAAO,CAAC,CAAC;YACzC,IAAI,OAAO,KAAK,KAAK,QAAQ,IAAI,KAAK,KAAK,IAAI,EAAE;gBAC/C,MAAM,iBAAiB,GAAG,KAAK,CAAC,oBAAoB,CAAC,CAAC;gBACtD,IAAI,OAAO,iBAAiB,KAAK,QAAQ,EAAE;oBACzC,YAAY,GAAG,iBAAiB,aAAjB,iBAAiB,cAAjB,iBAAiB,GAAI,mBAAmB,CAAC;iBACzD;aACF;SACF;KACF;IACD,OAAO;QACL,QAAQ,EAAE,CAAC,CAAC,YAAY;QACxB,KAAK,EAAE,YAAY;KACpB,CAAC;AACJ;;ACxNO,MAAM,UAAU,GAAGJ,gBAAK,CAAC,IAAI,CAClC,CAAC,EACC,UAAU,EACV,mBAAmB,EACnB,SAAS,EACT,YAAY,GAAG,SAAS,EACxB,YAAY,EACZ,gBAAgB,GACA;IAChB,MAAM,EAAE,mBAAmB,EAAE,GAAG,oBAAoB,EAAE,CAAC;IACvD,MAAM,SAAS,GAAG,mBAAmB,GAAG,CAAC,GAAG,CAAC,CAAC;IAC9C,MAAM,WAAW,GAAG,mBAAmB,GAAG,SAAS,CAAC;IAEpD,IAAI,EAAyB,CAAC;IAC9B,IAAI,CAAC,WAAW,EAAE;QAChB,EAAE,GAAG,mBAAmB,KAAK,SAAS,GAAG,IAAI,GAAG,CAAC,CAAC;KACnD;IAED,QACEA,+BAACM,UAAG,IACF,SAAS,EAAE,SAAS,EACpB,EAAE,EAAE,EAAE,EACN,QAAQ,EAAC,IAAI,EACb,OAAO,EAAE,WAAW,GAAG,SAAS,GAAG,IAAI,gBAC3B,mBAAmB,IAE9B,UAAU,CAAC,GAAG,CAAC,CAAC,SAAqB,MACpCN,+BAAC,YAAY,IACX,GAAG,EAAE,SAAS,CAAC,EAAE,EACjB,UAAU,EAAE,SAAS,EACrB,YAAY,EAAE,mBAAmB,GAAG,CAAC,EACrC,EAAE,EAAE,WAAW,GAAG,SAAS,GAAG,cAAc,EAC5C,YAAY,EAAE,YAAY,EAC1B,gBAAgB,EAAE,gBAAgB,GAClC,CACH,CAAC,CACE,EACN;AACJ,CAAC,CACF;;AC9CM,MAAM,gBAAgB,GAAG,CAAC,EAAE,QAAQ,EAAE,UAAU,EAAE,WAAW,EAAE,EAAE,QAAQ,EAAE,SAAS,EAAE,EAAe;IAC1G,MAAM,EAAE,QAAQ,EAAE,GAAG,oBAAoB,EAAE,CAAC;IAE5C,MAAM,yBAAyB,GAAG,QAAQ,KAAK,YAAY,IAAI,CAAC,CAAC,QAAQ,KAAK,CAAC,CAAC,SAAS,CAAC;IAE1F,OAAO,UAAU,IAAI,yBAAyB,IAAI,QAAQ,CAAC;AAC7D,CAAC,CAAC;AAEK,MAAM,UAAU,GAAyC,CAAC,EAC/D,QAAQ,EACR,UAAU,EACV,WAAW,EAAE,EAAE,QAAQ,EAAE,SAAS,EAAE,GACrC;IACC,MAAM,EAAE,QAAQ,EAAE,GAAG,oBAAoB,EAAE,CAAC;IAG5C,MAAM,yBAAyB,GAAG,QAAQ,KAAK,YAAY,IAAI,CAAC,CAAC,QAAQ,KAAK,CAAC,CAAC,SAAS,CAAC;IAC1F,MAAM,UAAU,GAAG,yBAAyB,IAC1C,QAAQ,IACNA,+BAACM,UAAG,IAAC,EAAE,EAAC,MAAM,EAAC,EAAE,EAAE,CAAC,EAAE,KAAK,EAAC,OAAO,gBAE7B,KAENN,+BAACM,UAAG,IAAC,EAAE,EAAC,MAAM,EAAC,EAAE,EAAE,CAAC,EAAE,KAAK,EAAC,OAAO,iBAE7B,CACP,IACC,IAAI,CAAC;IAET,QACEN;QACG,UAAU,IACTA,+BAACM,UAAG,IAAC,EAAE,EAAC,MAAM,EAAC,EAAE,EAAE,CAAC,EAAE,KAAK,EAAC,SAAS,iBAE/B,IACJ,IAAI;QACP,UAAU;QACV,QAAQ,KACPN,+BAACM,UAAG,IAAC,EAAE,EAAC,MAAM,EAAC,EAAE,EAAE,CAAC,EAAE,KAAK,EAAC,SAAS,eAE/B,CACP,CACA,EACH;AACJ,CAAC;;AC3CD,SAAS,oBAAoB,CAAC,IAAgB,EAAE,QAAiB;IAC/D,MAAM,eAAe,GAAG,QAAQ,GAAG,GAAG,GAAG,EAAE,CAAC;IAC5C,IAAIF,4BAAa,CAAC,IAAI,CAAC,EAAE;QACvB,MAAM,QAAQ,GAAG,SAAS,CAAC,IAAI,EAAE,EAAE,wBAAwB,EAAE,IAAI,EAAE,CAAC,CAAC;QACrE,IAAI,QAAQ,EAAE;YACZ,OAAO,QAAQ,CAAC;SACjB;QACD,OAAO,IAAI,CAAC,WAAW,KAAK,IAAI,GAAG,IAAI,CAAC,WAAW,GAAG,eAAe,GAAG,KAAK,CAAC;KAC/E;IACD,IAAIO,8BAAe,CAAC,IAAI,CAAC,EAAE;QACzB,IAAI,IAAI,CAAC,KAAK,EAAE;YACd,MAAM,KAAK,GAAGa,0BAAqB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YAChD,MAAM,SAAS,GAAG,CAAC,IAAI,CAAC,KAAK,IAAI,KAAK,GAAGC,wBAAI,CAACC,kBAAa,CAAC,KAAK,CAAC,CAAC,GAAG,IAAI,CAAC;YAC3E,IAAI,OAAO,SAAS,KAAK,QAAQ,EAAE;gBACjC,OAAO,SAAS,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;aAChC;SACF;QACD,OAAO,MAAM,GAAG,eAAe,CAAC;KACjC;IAED,OAAO,KAAK,CAAC;AACf,CAAC;AAED,SAAS,UAAU,CAAC,IAAgB;IAClC,OAAO;QACL,IAAI,EAAE,IAAI;QACV,KAAK,EAAE,oBAAoB,CAAC,IAAI,EAAE,KAAK,CAAC;KACzC,CAAC;AACJ,CAAC;AAED,SAAS,eAAe,CAAC,IAAgB,EAAE,QAAiB;IAC1D,MAAM,SAAS,GAAG,oBAAoB,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;IACnD,MAAM,KAAK,GAAG,SAAS,KAAK,KAAK,GAAG,SAAS,QAAQ,GAAG,IAAI,QAAQ,GAAG,GAAG,IAAI,KAAK,SAAS,GAAG,GAAG,OAAO,CAAC;IAC1G,OAAO;QACL,IAAI,EAAE,IAAI;QACV,KAAK;KACN,CAAC;AACJ,CAAC;AAQM,MAAM,UAAU,GAAG,CAAC,UAAsB;IAC/C,MAAM,OAAO,GAAa1B,gBAAK,CAAC,OAAO,CAAC;QAEtC,IACE,cAAc,CAAC,UAAU,CAAC;YAC1B,oBAAoB,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;YAC5C,uBAAuB,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,EAC/C;YACA,OAAO,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,GAAG,CAAC,KAAK,cAC9C,OAAA,eAAe,CAAC,KAAK,EAAE,MAAA,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,SAAS,0CAAG,CAAC,CAAC,CAAC,CAAA,EAAA,CAC9D,CAAC;SACH;QAGD,IAAI,oBAAoB,CAAC,UAAU,CAAC,IAAI,uBAAuB,CAAC,UAAU,CAAC,EAAE;YAC3E,OAAO,UAAU,CAAC,QAAQ,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;SAC5C;QAED,OAAO,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC,CAAC;KACjC,EAAE,CAAC,UAAU,CAAC,CAAC,CAAC;IAEjB,MAAM,aAAa,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC;IAEjC,MAAM,CAAC,cAAc,EAAE,iBAAiB,CAAC,GAAGA,gBAAK,CAAC,QAAQ,CAAqB,aAAa,CAAC,CAAC;IAE9FA,gBAAK,CAAC,SAAS,CAAC;QACd,iBAAiB,CAAC,aAAa,CAAC,CAAC;KAClC,EAAE,CAAC,aAAa,CAAC,CAAC,CAAC;IAEpB,MAAM,oBAAoB,GAAG,cAAc,IAAI,OAAO,CAAC,QAAQ,CAAC,cAAc,CAAC,GAAG,cAAc,GAAG,aAAa,CAAC;IAEjH,OAAO,EAAE,cAAc,EAAE,oBAAoB,EAAE,iBAAiB,EAAE,OAAO,EAAE,CAAC;AAC9E,CAAC,CAAC;AAEF,MAAM,uBAAuB,GAAG,CAAC,UAAsB,mBACrD,OAAA,oBAAoB,CAAC,UAAU,CAAC,IAAI,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC,QAAQ,CAAC,MAAA,MAAA,UAAU,CAAC,SAAS,0CAAG,CAAC,CAAC,mCAAI,EAAE,CAAC,CAAA,EAAA;;AC5DlG,MAAM,iBAAiB,GAA4C;IAEjE,KAAK,EAAE,SAAS;IAEhB,QAAQ,EAAE,SAAS;IAEnB,OAAO,EAAE,SAAS;CACnB,CAAC;AAEK,MAAM,SAAS,GAA4CA,gBAAK,CAAC,IAAI,CAC1E,CAAC,EAAE,UAAU,EAAE,YAAY,EAAE,EAAE,EAAE,YAAY,EAAE,gBAAgB,EAAE;;IAC/D,MAAM,EACJ,oBAAoB,EACpB,cAAc,EACd,SAAS,EACT,YAAY,EACZ,mBAAmB,EACnB,cAAc,EACd,QAAQ,GACT,GAAG,oBAAoB,EAAE,CAAC;IAE3B,MAAM,cAAc,GAAG2B,mBAAa,CAAC,eAAe,CAAC,CAAC;IAEtD,MAAM,MAAM,GAAG,SAAS,CAAC,UAAU,EAAE,YAAY,CAAC,CAAC;IAGnD,MAAM,cAAc,GAAG,CAAA,MAAA,UAAU,CAAC,gBAAgB,0CAAE,IAAI,IAAG,iBAAiB,CAAC,UAAU,EAAE,YAAY,CAAC,GAAG,MAAM,CAAC;IAChH,MAAM,IAAI,GAAG,QAAQ,KAAK,YAAY,GAAG,SAAS,GAAG,QAAQ,CAAC;IAC9D,MAAM,UAAU,GAAG,cAAc,aAAd,cAAc,uBAAd,cAAc,CAAG,EAAE,MAAM,EAAE,cAAc,EAAE,IAAI,EAAE,CAAC,CAAC;IAEtE,MAAM,CAAC,UAAU,EAAE,WAAW,CAAC,GAAG3B,gBAAK,CAAC,QAAQ,CAC9C,CAAC4B,6BAAc,CAAC,UAAU,CAAC,IAAI,YAAY,IAAI,oBAAoB,CACpE,CAAC;IAEF,MAAM,EAAE,cAAc,EAAE,iBAAiB,EAAE,OAAO,EAAE,GAAG,UAAU,CAAC,UAAU,CAAC,CAAC;IAC9E,MAAM,UAAU,GAAG,cAAc,CAAC,IAAI,CAAC;IACvC,MAAM,WAAW,GAAGxB,4BAAa,CAAC,UAAU,CAAC,GAAG,UAAU,CAAC,WAAW,CAAC,WAAW,GAAG,IAAI,CAAC;IAE1F,MAAM,OAAO,GAAGJ,gBAAK,CAAC,OAAO,CAAuB;;QAClD,IAAIW,8BAAe,CAAC,UAAU,CAAC,EAAE;YAC/B,OAAO,UAAU,CAAC;SACnB;QAED,IACEP,4BAAa,CAAC,UAAU,CAAC;aACxB,iBAAiB,CAAC,UAAU,CAAC;iBAC3B,UAAU,CAAC,WAAW,KAAKM,6BAAc,CAAC,KAAK,IAAI,CAAA,MAAA,UAAU,CAAC,QAAQ,0CAAE,MAAM,MAAK,CAAC,CAAC,CAAC,EACzF;YACA,OAAO,MAAC,MAAA,UAAU,CAAC,QAAQ,0CAAE,IAAI,CAACC,8BAAe,CAA+B,mCAAI,IAAI,CAAC;SAC1F;QAED,OAAO,IAAI,CAAC;KACb,EAAE,CAAC,UAAU,CAAC,CAAC,CAAC;IAEjB,MAAM,WAAW,GAAG,QAAO,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,KAAK,CAAA,KAAK,QAAQ,CAAC;IAEvD,MAAM,SAAS,GAAG,mBAAmB,GAAG,CAAC,GAAG,CAAC,CAAC;IAC9C,MAAM,UAAU,GAAGX,gBAAK,CAAC,OAAO,CAAC,MAAM,uBAAuB,CAAC,UAAU,CAAC,EAAE,CAAC,UAAU,CAAC,CAAC,CAAC;IAC1F,MAAM,QAAQ,GAAGI,4BAAa,CAAC,UAAU,CAAC,KAAI,MAAA,UAAU,CAAC,SAAS,0CAAE,MAAM,CAAA,GAAG,UAAU,CAAC,SAAS,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC;IAC5G,MAAM,aAAa,GAAG,UAAU,CAAC,MAAM,GAAG,CAAC,CAAC;IAC5C,MAAM,WAAW,GAAG,YAAY,GAAG,SAAS,CAAC;IAE7C,MAAM,QAAQ,GAAG,kBAAkB,CAAC,UAAU,CAAC,CAAC;IAChD,MAAM,UAAU,GAAGA,4BAAa,CAAC,UAAU,CAAC,IAAI,UAAU,CAAC,UAAU,CAAC;IACtE,MAAM,WAAW,GAAGA,4BAAa,CAAC,UAAU,CAAC,GAAG,UAAU,CAAC,WAAW,GAAG,EAAE,CAAC;IAC5E,MAAM,aAAa,GAAG,gBAAgB,CAAC,EAAE,QAAQ,EAAE,UAAU,EAAE,WAAW,EAAE,CAAC,CAAC;IAE9E,MAAM,mBAAmB,GAAG,sBAAsB,CAAC,UAAU,CAAC,CAAC;IAE/D,MAAM,oBAAoB,GAAG,mBAAmB,GAAG,CAAC,GAAG,CAAC,CAAC;IACzD,IAAI,oBAAoB,GAAG,CAAC,EAAE,GAAG,oBAAoB,CAAC;IACtD,IAAI,YAAY,GAAG,CAAC,EAAE;QAEpB,oBAAoB;YAClB,CAAC,CAAC,GAAG,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC,YAAY,GAAG,CAAC,EAAE,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,YAAY,EAAE,CAAC,CAAC,GAAG,CAAC,GAAG,EAAE,GAAG,oBAAoB,CAAC;QAEtG,IAAI,CAAC,mBAAmB,EAAE;YACxB,oBAAoB,IAAI,EAAE,CAAC;SAC5B;KACF;IAED,IAAI,gBAAgB,KAAK,OAAO,IAAI,UAAU,IAAI,UAAU,CAAC,IAAI,KAAK,SAAS,EAAE;QAC/E,OAAO,IAAI,CAAC;KACb;IAED,IAAI,gBAAgB,KAAK,SAAS,IAAI,UAAU,IAAI,UAAU,CAAC,IAAI,KAAK,OAAO,EAAE;QAC/E,OAAO,IAAI,CAAC;KACb;IAED,QACEJ;QACEA,+BAACY,WAAI,IACH,IAAI,EAAC,MAAM,EACX,EAAE,EAAE,EAAE,EACN,EAAE,EAAE,CAAC,aACI,cAAc,EACvB,GAAG,EAAC,UAAU,EACd,YAAY,EAAE,CAAC,CAAM;gBACnB,CAAC,CAAC,eAAe,EAAE,CAAC;gBACpB,cAAc,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;aACrC;YAEA,CAAC,WAAW,IAAIZ,+BAACM,UAAG,IAAC,OAAO,QAAC,CAAC,EAAE,aAAa,GAAG,CAAC,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,GAAI;YAE/E,gBAAgB,KAAK,OAAO,IAAI,gBAAgB,KAAK,SAAS,IAC7DN,+BAAC,gBAAgB,IAAC,MAAM,EAAE,UAAU,EAAE,KAAK,EAAE,EAAE,IAAI,EAAE,oBAAoB,EAAE,GAAI,IAC7E,IAAI;YAERA,+BAAC6B,aAAM,IAAC,OAAO,EAAE,CAAC,EAAE,IAAI,EAAC,MAAM,EAAC,IAAI,EAAE,CAAC,EAAE,EAAE,EAAE,aAAa,IAAI,CAAC,WAAW,GAAG,CAAC,GAAG,SAAS;gBACxF7B,+BAACY,WAAI,IACH,UAAU,EAAC,QAAQ,EACnB,IAAI,EAAC,MAAM,EACX,OAAO,EAAE,aAAa,GAAG,MAAM,WAAW,CAAC,CAAC,UAAU,CAAC,GAAG,SAAS,EACnE,MAAM,EAAE,aAAa,GAAG,SAAS,GAAG,SAAS;oBAE5C,aAAa,GAAGZ,+BAAC,KAAK,IAAC,UAAU,EAAE,UAAU,GAAI,GAAG,IAAI;oBAEzDA,+BAACY,WAAI,IAAC,UAAU,EAAC,UAAU,EAAC,QAAQ,EAAC,MAAM;wBACxC,UAAU,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,IAAI,sBAAsB,CAAC,UAAU,CAAC,KAClEZ,+BAACM,UAAG,IAAC,EAAE,EAAE,CAAC,EAAE,UAAU,EAAC,MAAM,EAAC,UAAU,EAAC,UAAU,IAChDmB,wBAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CACrB,CACP;wBAEA,OAAO,CAAC,MAAM,KAAK,CAAC,IAAIzB,+BAAC,KAAK,IAAC,UAAU,EAAE,UAAU,GAAI;wBAEzD,SAAS,IAAIW,8BAAe,CAAC,UAAU,CAAC,IAAI,UAAU,CAAC,QAAQ,IAC9DX,+BAACM,UAAG,IACF,EAAE,EAAC,GAAG,EACN,EAAE,EAAE,CAAC,EACL,MAAM,EAAC,SAAS,EAChB,KAAK,EAAC,eAAe,EACrB,OAAO,EAAE,CAAC,CAAmB;gCAC3B,CAAC,CAAC,cAAc,EAAE,CAAC;gCACnB,CAAC,CAAC,eAAe,EAAE,CAAC;gCACpB,SAAS,CAAC,UAAU,CAAC,CAAC;6BACvB,kBAGG,IACJ,IAAI;wBAEP,UAAU,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,IAAI,UAAU,CAAC,OAAO,CAAC,CAAC,CAAC,KAAK,mBAAmB,IAC7EN,+BAACM,UAAG,IAAC,EAAE,EAAE,CAAC,EAAE,KAAK,EAAC,OAAO,yBAEnB,IACJ,IAAI;wBAEP,OAAO,CAAC,MAAM,GAAG,CAAC,KACjBN,+BAAC8B,aAAM,kBACM,aAAa,EACxB,IAAI,EAAC,IAAI,EACT,iBAAiB,EAAE,QAAQ,GAAG,GAAG,iBAAiB,CAAC,QAAQ,CAAC,IAAI,GAAG,SAAS,EAC5E,OAAO,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,KAAK,MAAM;gCACvC,KAAK,EAAE,MAAM,CAAC,KAAK,CAAC;gCACpB,KAAK,EAAE,MAAM,CAAC,KAAK;6BACpB,CAAC,CAAC,EACH,KAAK,EACH,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC,EAGzC,QAAQ,EAAE,aAAa,IAAI,iBAAiB,CAAC,OAAO,CAAC,aAAuB,CAAC,CAAC,GAC9E,CACH,CACI;oBAEN,aAAa,IAAI9B,+BAAC,OAAO,IAAC,IAAI,EAAE,iBAAiB,CAAC,UAAU,CAAC,GAAI;oBAElEA,+BAAC,UAAU,IAAC,QAAQ,EAAE,QAAQ,EAAE,UAAU,EAAE,UAAU,EAAE,WAAW,EAAE,WAAW,GAAI,CAC/E;gBAEN,OAAO,WAAW,KAAK,QAAQ,IAAI,WAAW,CAAC,MAAM,GAAG,CAAC,IAAIA,+BAAC,WAAW,IAAC,KAAK,EAAE,WAAW,GAAI;gBAEjGA,+BAAC,WAAW,IACV,WAAW,EAAEI,4BAAa,CAAC,UAAU,CAAC,GAAG,wBAAwB,CAAC,UAAU,CAAC,GAAG,EAAE,EAClF,YAAY,EAAE,YAAY,GAC1B;gBAED,CAAC,WAAW,IAAI,mBAAmB,CAAC,QAAQ,MAC3CJ,+BAACa,WAAI,IACH,KAAK,EAAE,CAAA,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,KAAM,KAAI,mBAAmB,CAAC,KAAK,EACnD,KAAK,EAAC,QAAQ,EACd,IAAI,EAAE,CAAC,KAAK,EAAE,sBAAsB,CAAC,EACrC,IAAI,EAAC,IAAI,GACT,CACH,CACM;YAER,cAAc,GAAGb,+BAACM,UAAG,QAAE,cAAc,CAAC,EAAE,UAAU,EAAE,YAAY,EAAE,CAAC,CAAO,GAAG,IAAI,CAC7E;QAEN,aAAa,IAAI,UAAU,IAC1BN,+BAAC,UAAU,IACT,UAAU,EAAE,UAAU,EACtB,UAAU,EAAE,UAAU,EACtB,mBAAmB,EAAE,YAAY,EACjC,YAAY,EAAE,MAAM,EACpB,gBAAgB,EAAE,gBAAgB,GAAG,gBAAgB,GAAG,UAAU,GAAG,UAAU,aAAV,UAAU,uBAAV,UAAU,CAAE,IAAI,GAAG,SAAS,GACjG,IACA,IAAI,CACP,EACH;AACJ,CAAC,CACF,CAAC;AAEF,MAAM,gBAAgB,GAAG,CAAC,EAAiF;QAAjF,EAAE,MAAM,OAAyE,EAApE,KAAK,cAAlB,UAAoB,CAAF;IAC1C,IAAI,CAAC,MAAM;QAAE,OAAO,IAAI,CAAC;IAEzB,MAAM,EAAE,KAAK,GAAG,EAAE,KAAc,KAAK,EAAd,IAAI,UAAK,KAAK,EAA/B,SAAuB,CAAQ,CAAC;IAGtC,MAAM,YAAY,GAAG,MAAM,CAAC,YAAY,IAAI,MAAM,CAAC,IAAI,KAAK,OAAO,IAAI,MAAM,CAAC,IAAI,KAAK,SAAS,CAAC;IAEjG,QACEA,+BAACM,UAAG,kBACF,CAAC,EAAE,GAAG,EACN,GAAG,EAAC,UAAU,EACd,IAAI,EAAC,IAAI,EACT,EAAE,EAAE,YAAY,GAAG,iBAAiB,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,SAAS,EAC7D,OAAO,QACP,KAAK,kCACA,KAAK,KACR,WAAW,EAAE,CAAC,EACd,WAAW,EAAE,YAAY,GAAG,aAAa,GAAG,iBAAiB,CAAC,MAAM,CAAC,IAAI,CAAC,OAExE,IAAI;QAERN,+BAACM,UAAG,IAAC,GAAG,EAAC,UAAU,EAAC,KAAK,EAAE,CAAC,EAAE,IAAI,QAAC,QAAQ,EAAC,IAAI,EAAC,OAAO,EAAC,MAAM,EAAC,UAAU,EAAC,QAAQ,IAChF,MAAM,CAAC,UAAU,IAChBN,+BAACM,UAAG,IAAC,KAAK,EAAC,QAAQ;YACjBN,+BAACa,WAAI,IAAC,IAAI,EAAE,CAAC,YAAY,GAAG,KAAK,GAAG,KAAK,EAAE,oBAAoB,CAAC,GAAI,CAChE,IACJ,IAAI,CACJ,CACF,EACN;AACJ,CAAC,CAAC;AAEF,MAAM,OAAO,GAAG,CAAC,EAAE,IAAI,EAA2B;IAChD,MAAM,UAAU,GAAGkB,kBAAY,CAAC,IAAI,CAAC,CAAC;IAEtC,OAAO/B,+BAACM,UAAG,IAAC,EAAE,EAAE,UAAU,GAAG,YAAY,GAAG,SAAS,EAAE,CAAC,EAAC,IAAI,EAAC,IAAI,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,GAAI,CAAC;AACnF,CAAC,CAAC;AAEF,SAAS,sBAAsB,CAAC,UAAsB;IACpD,QACE,UAAU,CAAC,OAAO,CAAC,MAAM,KAAK,CAAC;SAC9B,UAAU,CAAC,OAAO,CAAC,CAAC,CAAC,KAAK,YAAY,IAAI,UAAU,CAAC,OAAO,CAAC,CAAC,CAAC,KAAK,mBAAmB,CAAC,EACzF;AACJ;;ACxRO,MAAM,aAAa,GAAG,CAAC,GAA2B;IACvD,MAAM,CAAC,UAAU,EAAE,aAAa,CAAC,GAAG0B,cAAQ,CAAC,IAAI,CAAC,CAAC;IAEnDC,eAAS,CAAC;QAGR,IAAI,GAAG,CAAC,OAAO,EAAE;YACf,MAAM,YAAY,GAAG,eAAe,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;YAClD,MAAM,QAAQ,GAAG,IAAI,oBAAoB,CACvC,CAAC,CAAC,KAAK,CAAC;gBACN,aAAa,CAAC,KAAK,CAAC,cAAc,CAAC,CAAC;aACrC,EACD;gBACE,IAAI,EAAE,YAAY,KAAK,MAAM,GAAG,SAAS,GAAI,YAA4B;gBACzE,UAAU,EAAE,kBAAkB;aAC/B,CACF,CAAC;YAEF,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;SAC/B;QAED,OAAO;SAEN,CAAC;KACH,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC;IAEV,OAAO,UAAU,CAAC;AACpB,CAAC,CAAC;AAEF,SAAS,eAAe,CAAC,IAAwB;IAC/C,IAAI,IAAI,IAAI,IAAI,EAAE;QAChB,OAAO,IAAI,CAAC;KACb;IAED,IAAI,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,GAAG,CAAC,EAAE;QAClE,OAAO,IAAI,CAAC,OAAO,KAAK,MAAM,GAAG,MAAM,GAAG,IAAI,CAAC;KAChD;SAAM;QACL,OAAO,eAAe,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;KAC5C;AACH;;AC1BO,MAAM,iBAAiB,GAAG,CAAC,EAAE,UAAU,EAAsC;;IAClF,MAAM,EAAE,cAAc,EAAE,iBAAiB,EAAE,OAAO,EAAE,GAAG,UAAU,CAAC,UAAU,CAAC,CAAC;IAC9E,MAAM,UAAU,GAAGjC,gBAAK,CAAC,OAAO,CAAC,MAAM,uBAAuB,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,CAAC;IAC5G,MAAM,YAAY,GAAG,CAAC,CAAC;IAEvB,MAAM,MAAM,GAAG,MAAA,MAAA,UAAU,CAAC,QAAQ,0CAAG,aAAa,CAAC,0CAAE,EAAE,CAAC;IAExD,MAAM,mBAAmB,GAAG,sBAAsB,CAAC,UAAU,CAAC,CAAC;IAG/D,IAAII,4BAAa,CAAC,UAAU,CAAC,IAAI,gBAAgB,CAAC,UAAU,CAAC,EAAE;QAC7D,QACEJ;YACEA,+BAAC,WAAW,OAAG;YACfA,+BAAC,WAAW,IAAC,KAAK,EAAE,UAAU,CAAC,WAAW,CAAC,WAAW,GAAI;YAC1DA,+BAAC,UAAU,IACT,UAAU,EAAE,UAAU,EACtB,UAAU,EAAE,UAAU,EACtB,mBAAmB,EAAE,YAAY,EACjC,YAAY,EAAE,MAAM,GACpB;YACD,mBAAmB,CAAC,QAAQ,KAC3BA,+BAACa,WAAI,IAAC,KAAK,EAAE,mBAAmB,CAAC,KAAK,EAAE,KAAK,EAAC,QAAQ,EAAC,IAAI,EAAE,CAAC,KAAK,EAAE,sBAAsB,CAAC,EAAE,IAAI,EAAC,IAAI,GAAG,CAC3G,CACA,EACH;KACH;IAED,IAAIT,4BAAa,CAAC,UAAU,CAAC,IAAI,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;QACnD,MAAM,QAAQ,GAAGA,4BAAa,CAAC,UAAU,CAAC,KAAI,MAAA,UAAU,CAAC,SAAS,0CAAE,MAAM,CAAA,GAAG,UAAU,CAAC,SAAS,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC;QAE5G,QACEJ;YACEA,+BAAC,WAAW,OAAG;YACfA,+BAAC,WAAW,IAAC,KAAK,EAAE,UAAU,CAAC,WAAW,CAAC,WAAW,GAAI;YAE1DA,+BAACO,aAAM,IAAC,OAAO,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC;gBACvBP,+BAACkC,WAAI,kBACQ,aAAa,EACxB,YAAY,QACZ,SAAS,EAAC,aAAa,EACvB,KAAK,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,KAAK,MAAM;wBACrC,EAAE,EAAE,KAAK;wBACT,KAAK,EAAE,MAAM,CAAC,KAAK;wBACnB,OAAO,EAAE,MAAM,iBAAiB,CAAC,MAAM,CAAC;qBACzC,CAAC,CAAC,EACH,aAAa,EAAE,KAAK,KAClBlC,+BAACmC,gBAAS,oBAAK,KAAK;wBAClBnC,+BAACY,WAAI,IAAC,UAAU,EAAC,MAAM,EAAC,UAAU,EAAC,UAAU,EAAC,MAAM,EAAC,SAAS,EAAC,QAAQ,EAAC,MAAM;4BAC3E,cAAc,CAAC,KAAK;4BACrBZ,+BAACM,UAAG,IAAC,EAAE,EAAE,CAAC;gCACRN,+BAACa,WAAI,IAAC,IAAI,EAAE,CAAC,KAAK,EAAE,YAAY,CAAC,GAAI,CACjC,CACD,CACG,CACb,GACD;gBAED,QAAQ,KAAK,IAAI,IAChBb,+BAACY,WAAI,IAAC,UAAU,EAAC,QAAQ,EAAC,KAAK,EAAC,OAAO,EAAC,QAAQ,EAAC,MAAM,IACpD,IAAI,iBAAiB,CAAC,QAAQ,CAAC,GAAG,CAC9B,IACL,IAAI,CACD;YAER,UAAU,CAAC,MAAM,GAAG,CAAC,IACpBZ,+BAAC,UAAU,IACT,UAAU,EAAE,UAAU,EACtB,UAAU,EAAE,UAAU,EACtB,mBAAmB,EAAE,YAAY,EACjC,YAAY,EAAE,MAAM,GACpB,IACA,IAAI,CACP,EACH;KACH;IAED,IAAI,cAAc,CAAC,UAAU,CAAC,IAAI,gBAAgB,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,EAAE;QAC1E,QACEA;YACEA,+BAAC,WAAW,OAAG;YACfA,+BAAC,WAAW,IAAC,KAAK,EAAE,UAAU,CAAC,WAAW,CAAC,WAAW,GAAI;YAE1DA,+BAACM,UAAG,IAAC,UAAU,EAAC,MAAM,EAAC,UAAU,EAAC,UAAU,EAAC,QAAQ,EAAC,MAAM,EAAC,EAAE,EAAE,CAAC,gBAE5D;YAEL,UAAU,CAAC,MAAM,GAAG,CAAC,IACpBN,+BAAC,UAAU,IACT,UAAU,EAAE,UAAU,EACtB,UAAU,EAAE,UAAU,EACtB,mBAAmB,EAAE,YAAY,EACjC,YAAY,EAAE,MAAM,GACpB,IACA,IAAI,CACP,EACH;KACH;IAED,QACEA;QACEA,+BAAC,WAAW,OAAG;QACfA,+BAAC,SAAS,IAAC,UAAU,EAAE,UAAU,EAAE,YAAY,EAAE,YAAY,GAAI,CAChE,EACH;AACJ,CAAC,CAAC;AAEF,SAAS,WAAW;IAClB,MAAM,UAAU,GAAGA,gBAAK,CAAC,MAAM,CAAiB,IAAI,CAAC,CAAC;IAEtD,MAAM,UAAU,GAAG,aAAa,CAAC,UAAU,CAAC,CAAC;IAC7C,MAAM,iBAAiB,GAAG2B,mBAAa,CAAC,kBAAkB,CAAC,CAAC;IAC5D3B,gBAAK,CAAC,SAAS,CAAC;QACd,iBAAiB,CAAC,CAAC,UAAU,CAAC,CAAC;KAChC,EAAE,CAAC,UAAU,EAAE,iBAAiB,CAAC,CAAC,CAAC;IAEpC,OAAOA,wCAAK,GAAG,EAAE,UAAU,GAAI,CAAC;AAClC,CAAC;AAED,SAAS,gBAAgB,CAAC,UAAuB;;IAC/C,OAAO,UAAU,CAAC,WAAW,KAAK,QAAQ,IAAI,CAAA,MAAA,UAAU,CAAC,KAAK,0CAAE,MAAM,MAAK,CAAC,CAAC;AAC/E;;AC1GA,MAAM,yBAAyB,GAAG,CAAC,EAUa;QAVb,EACjC,QAAQ,GAAG,YAAY,EACvB,oBAAoB,GAAG,CAAC,EACxB,SAAS,EACT,cAAc,EACd,YAAY,EACZ,mBAAmB,EACnB,aAAa,EACb,cAAc,OAEgC,EAD3C,IAAI,cAT0B,6IAUlC,CADQ;IAEP,MAAM,OAAO,GAAGA,gBAAK,CAAC,OAAO,CAC3B,OAAO;QACL,oBAAoB;QACpB,QAAQ;QACR,SAAS;QACT,cAAc;QACd,YAAY;QACZ,mBAAmB;QACnB,aAAa;QACb,cAAc;KACf,CAAC,EACF;QACE,oBAAoB;QACpB,QAAQ;QACR,SAAS;QACT,cAAc;QACd,YAAY;QACZ,mBAAmB;QACnB,aAAa;QACb,cAAc;KACf,CACF,CAAC;IAEF,QACEA,+BAACoC,eAAc;QACbpC,+BAAC,yBAAyB,IAAC,KAAK,EAAE,OAAO;YACvCA,+BAACqC,cAAQ;gBACPrC,+BAAC,qBAAqB,kBAAC,QAAQ,EAAE,QAAQ,IAAM,IAAI,EAAI,CAC9C,CACe,CACb,EACjB;AACJ,CAAC,CAAC;AAEF,MAAM,qBAAqB,GAAG,CAAC,EAC7B,MAAM,EACN,QAAQ,EACR,SAAS,EACT,UAAU,EACV,SAAS,GAAG,mBAAmB,EAC/B,eAAe,EACf,SAAS,EACT,YAAY,GAIb;IACC,MAAM,cAAc,GAAG2B,mBAAa,CAAC,eAAe,CAAC,CAAC;IACtD,MAAM,YAAY,GAAG3B,gBAAK,CAAC,WAAW,CAAC;QACrC,cAAc,CAAC,IAAI,CAAC,CAAC;KACtB,EAAE,CAAC,cAAc,CAAC,CAAC,CAAC;IAErB,MAAM,EAAE,kBAAkB,EAAE,SAAS,EAAE,GAAGA,gBAAK,CAAC,OAAO,CAAC;QACtD,MAAMsC,gBAAc,GAAG,IAAIC,yBAAc,CAAC,MAAM,EAAE;YAChD,UAAU,EAAE,IAAI;YAChB,WAAW,EAAE,UAAU;SACxB,CAAC,CAAC;QAEH,IAAI,SAAS,GAAG,CAAC,CAAC;QAClB,MAAM,oBAAoB,GAAG,CAAC,IAAgB;YAC5C,IAAI,CAACnC,4BAAa,CAAC,IAAI,CAAC;gBAAE,OAAO,IAAI,CAAC;YAEtC,MAAM,EAAE,WAAW,EAAE,GAAG,IAAI,CAAC;YAE7B,IAAI,CAAC,CAAC,WAAW,CAAC,SAAS,KAAK,CAAC,CAAC,WAAW,CAAC,QAAQ,EAAE;gBACtD,OAAO,IAAI,CAAC;aACb;YAED,OAAO,EAAE,CAAC,QAAQ,KAAK,MAAM,IAAI,CAAC,CAAC,WAAW,CAAC,SAAS,MAAM,QAAQ,KAAK,OAAO,IAAI,CAAC,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,CAAC;SAChH,CAAC;QAEFkC,gBAAc,CAAC,MAAM,CAAC,QAAQ,CAAC,QAAQ,EAAE,IAAI;YAC3C,IAAI,oBAAoB,CAAC,IAAI,CAAC,EAAE;gBAC9B,SAAS,EAAE,CAAC;gBACZ,OAAO,IAAI,CAAC;aACb;YACD,OAAO,KAAK,CAAC;SACd,CAAC,CAAC;QACHA,gBAAc,CAAC,QAAQ,EAAE,CAAC;QAE1B,OAAO;YACL,kBAAkB,EAAEA,gBAAc,CAAC,IAAI;YACvC,SAAS;SACV,CAAC;KACH,EAAE,CAAC,MAAM,EAAE,UAAU,EAAE,QAAQ,CAAC,CAAC,CAAC;IAEnCtC,gBAAK,CAAC,SAAS,CAAC;QACd,eAAe,aAAf,eAAe,uBAAf,eAAe,CAAG;YAChB,QAAQ,EAAE,kBAAkB;YAC5B,SAAS,EAAE,SAAS;SACrB,CAAC,CAAC;KACJ,EAAE,CAAC,kBAAkB,EAAE,eAAe,EAAE,SAAS,CAAC,CAAC,CAAC;IAErD,MAAM,OAAO,GAAGA,gBAAK,CAAC,OAAO,CAC3B,MAAM,kBAAkB,CAAC,QAAQ,CAAC,KAAK,CAAC,IAAI,IAAI,CAACI,4BAAa,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,OAAO,CAAC,EACrF,CAAC,kBAAkB,CAAC,CACrB,CAAC;IACF,IAAI,OAAO,EAAE;QACX,QACEJ,+BAACM,UAAG,IAAC,SAAS,EAAEkC,sBAAE,CAAC,SAAS,EAAE,kBAAkB,CAAC,EAAE,QAAQ,EAAC,IAAI,IAC7D,SAAS,CACN,EACN;KACH;IAED,QACExC,+BAACM,UAAG,IACF,SAAS,EAAEkC,sBAAE,CAAC,kBAAkB,EAAE,SAAS,CAAC,EAC5C,GAAG,EAAE,SAAS,GAAG,UAAU,GAAG,SAAS,EACvC,SAAS,EAAE,SAAS,GAAG,MAAM,GAAG,SAAS,EACzC,YAAY,EAAE,YAAY,EAC1B,KAAK,EAAE,EAAE,SAAS,EAAE;QAEpBxC,+BAAC,UAAU,IAAC,YAAY,EAAE,YAAY,GAAI;QAC1CA,+BAAC,iBAAiB,IAAC,UAAU,EAAE,kBAAkB,CAAC,QAAQ,CAAC,CAAC,CAAC,GAAI,CAC7D,EACN;AACJ,CAAC,CAAC;AAEF,MAAM,2BAA2B,GAAG,CAAC,EAAE,KAAK,EAAiB;IAC3D,QACEA,+BAACM,UAAG,IAAC,CAAC,EAAE,CAAC;QACPN,+BAACM,UAAG,IAAC,EAAE,EAAC,GAAG,EAAC,KAAK,EAAC,QAAQ,YAEpB;QACL,KAAK,KAAK,IAAI,GAAG,KAAK,KAAK,CAAC,OAAO,EAAE,GAAG,IAAI,CACzC,EACN;AACJ,CAAC,CAAC;MAEW,gBAAgB,GAAGmC,oCAAiB,CAAkB,yBAAyB,EAAE;IAC5F,iBAAiB,EAAE,2BAA2B;IAC9C,gBAAgB,EAAE,CAAC,QAAQ,CAAC;CAC7B;;;;;"}