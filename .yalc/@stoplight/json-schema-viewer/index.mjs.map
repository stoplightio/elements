{"version":3,"file":"index.mjs","sources":["../src/contexts/jsvOptions.tsx","../src/components/PathCrumbs/index.tsx","../src/consts.ts","../src/guards/isNonNullable.ts","../src/tree/utils.ts","../src/components/shared/Caret.tsx","../src/components/shared/Description.tsx","../src/components/shared/Format.tsx","../src/utils/printName.ts","../src/components/shared/Types.tsx","../src/components/shared/Validations.tsx","../src/components/shared/ChildStack.tsx","../src/components/shared/Properties.tsx","../src/components/SchemaRow/useChoices.ts","../src/components/SchemaRow/SchemaRow.tsx","../src/hooks/useIsOnScreen.ts","../src/components/SchemaRow/TopLevelSchemaRow.tsx","../src/components/JsonSchemaViewer.tsx"],"sourcesContent":["import * as React from 'react';\n\nimport { GoToRefHandler, RowAddonRenderer, ViewMode } from '../types';\n\nexport type JSVOptions = {\n  defaultExpandedDepth: number;\n  viewMode: ViewMode;\n  onGoToRef?: GoToRefHandler;\n  renderRowAddon?: RowAddonRenderer;\n  hideExamples?: boolean;\n  renderRootTreeLines?: boolean;\n  disableCrumbs?: boolean;\n};\n\nconst JSVOptionsContext = React.createContext<JSVOptions>({\n  defaultExpandedDepth: 0,\n  viewMode: 'standalone',\n  hideExamples: false,\n});\n\nexport const useJSVOptionsContext = () => React.useContext(JSVOptionsContext);\n\nexport const JSVOptionsContextProvider = JSVOptionsContext.Provider;\n","import { isRegularNode, isRootNode, SchemaNode } from '@stoplight/json-schema-tree';\nimport { Box, HStack } from '@stoplight/mosaic';\nimport { atom, useAtom } from 'jotai';\nimport * as React from 'react';\n\nimport { useJSVOptionsContext } from '../../contexts';\n\nexport const showPathCrumbsAtom = atom<boolean>(false);\n\nexport const pathCrumbsAtom = atom([], (_get, set, node) => {\n  set(pathCrumbsAtom, propertyPathToObjectPath(node as SchemaNode));\n});\n\nexport const PathCrumbs = ({ parentCrumbs = [] }: { parentCrumbs?: string[] }) => {\n  const [showPathCrumbs] = useAtom(showPathCrumbsAtom);\n  const [pathCrumbs] = useAtom(pathCrumbsAtom);\n  const { disableCrumbs } = useJSVOptionsContext();\n\n  if (disableCrumbs) {\n    return null;\n  }\n\n  const parentCrumbElems: React.ReactNodeArray = [];\n  parentCrumbs.forEach((crumb, i) => {\n    parentCrumbElems.push(<Box key={i}>{crumb}</Box>);\n  });\n\n  const pathCrumbElems: React.ReactNodeArray = [];\n  pathCrumbs.forEach((crumb, i) => {\n    if (pathCrumbs[i + 1]) {\n      pathCrumbElems.push(<Box key={i}>{crumb}</Box>);\n    } else {\n      pathCrumbElems.push(\n        <Box key={i} color=\"body\" fontWeight=\"semibold\">\n          {crumb}\n        </Box>,\n      );\n    }\n  });\n\n  // only show when have a path, and only when we've scrolled enough such that a portion of the JSV is no longer visible\n  if (!showPathCrumbs || (!parentCrumbElems.length && !pathCrumbElems.length)) {\n    return null;\n  }\n\n  return (\n    <HStack\n      spacing={1}\n      divider={<Box>/</Box>}\n      h=\"md\"\n      // so that the crumbs take up no space in the dom, and thus do not push content down when they appear\n      mt={-8}\n      borderB\n      pos=\"sticky\"\n      top={0}\n      fontFamily=\"mono\"\n      fontSize=\"sm\"\n      lineHeight=\"none\"\n      zIndex={10}\n      bg=\"canvas-pure\"\n      px=\"px\"\n      color=\"light\"\n      alignItems=\"center\"\n    >\n      {parentCrumbElems}\n      {pathCrumbElems.length && <HStack divider={<Box fontWeight=\"bold\">.</Box>}>{pathCrumbElems}</HStack>}\n    </HStack>\n  );\n};\n\nfunction propertyPathToObjectPath(node: SchemaNode) {\n  const objectPath: string[] = [];\n\n  let currentNode: SchemaNode | null = node;\n  while (currentNode && !isRootNode(currentNode)) {\n    if (isRegularNode(currentNode)) {\n      const pathPart = currentNode.subpath[currentNode.subpath.length - 1];\n\n      if (currentNode.primaryType === 'array') {\n        const key = `${pathPart || ''}[]`;\n        if (objectPath[objectPath.length - 1]) {\n          objectPath[objectPath.length - 1] = key;\n        } else {\n          objectPath.push(key);\n        }\n      } else if (\n        pathPart &&\n        (currentNode.subpath.length !== 2 || !['allOf', 'oneOf', 'anyOf'].includes(currentNode.subpath[0]))\n      ) {\n        objectPath.push(currentNode.subpath[currentNode.subpath.length - 1]);\n      }\n    }\n\n    currentNode = currentNode.parent;\n  }\n\n  return objectPath.reverse();\n}\n","import { SchemaCombinerName } from '@stoplight/json-schema-tree';\nimport { SpaceVals } from '@stoplight/mosaic';\nimport { Dictionary } from '@stoplight/types';\n\nexport const COMBINER_PRETTY_NAMES: Readonly<Dictionary<string, SchemaCombinerName>> = {\n  [SchemaCombinerName.AllOf]: 'and',\n  [SchemaCombinerName.AnyOf]: 'and/or',\n  [SchemaCombinerName.OneOf]: 'or',\n};\n\nexport const NESTING_OFFSET: SpaceVals = 3;\n\nexport const CARET_ICON_SIZE = 'sm';\n\nexport const COMBINER_NAME_MAP: Dictionary<string, SchemaCombinerName> = {\n  allOf: 'all of',\n  anyOf: 'any of',\n  oneOf: 'one of',\n};\n","export function isNonNullable<T = unknown>(maybeNullable: T): maybeNullable is NonNullable<T> {\n  return maybeNullable !== void 0 && maybeNullable !== null;\n}\n","import {\n  isReferenceNode,\n  isRegularNode,\n  MirroredSchemaNode,\n  ReferenceNode,\n  RegularNode,\n  SchemaNode,\n  SchemaNodeKind,\n} from '@stoplight/json-schema-tree';\n\nimport { isNonNullable } from '../guards/isNonNullable';\nimport { ComplexArrayNode, FlattenableNode, PrimitiveArrayNode } from './types';\n\nexport type ChildNode = RegularNode | ReferenceNode | MirroredSchemaNode;\n\nexport const isNonEmptyParentNode = (\n  node: SchemaNode,\n): node is RegularNode & {\n  children: ChildNode[] & { 0: ChildNode };\n} => isRegularNode(node) && !!node.children && node.children.length > 0;\n\nexport function isFlattenableNode(node: SchemaNode): node is FlattenableNode {\n  if (!isRegularNode(node)) return false;\n\n  if (node.primaryType !== SchemaNodeKind.Array || !isNonNullable(node.children) || node.children.length === 0) {\n    return false;\n  }\n\n  return (\n    node.children.length === 1 &&\n    (isRegularNode(node.children[0]) || (isReferenceNode(node.children[0]) && node.children[0].error !== null))\n  );\n}\n\nexport function isPrimitiveArray(node: SchemaNode): node is PrimitiveArrayNode {\n  return isFlattenableNode(node) && isRegularNode(node.children[0]) && node.children[0].simple;\n}\n\nexport function isComplexArray(node: SchemaNode): node is ComplexArrayNode {\n  return isFlattenableNode(node) && isRegularNode(node.children[0]) && !node.children[0].simple;\n}\n\n/**\n * Returns the children of `node` that should be displayed in the tree.\n * Defaults to `node.children`, except for Arrays that get special handling (flattening).\n */\nexport function calculateChildrenToShow(node: SchemaNode): SchemaNode[] {\n  if (!isRegularNode(node) || isPrimitiveArray(node)) {\n    return [];\n  }\n  if (isComplexArray(node)) {\n    // flatten the tree here, and show the properties of the item type directly\n    return node.children[0].children ?? [];\n  }\n  return node.children ?? [];\n}\n\nexport function isPropertyRequired(schemaNode: SchemaNode): boolean {\n  const { parent } = schemaNode;\n  if (parent === null || !isRegularNode(parent) || schemaNode.subpath.length === 0) {\n    return false;\n  }\n\n  return !!parent.required?.includes(schemaNode.subpath[schemaNode.subpath.length - 1]);\n}\n","import { Flex, Icon } from '@stoplight/mosaic';\nimport * as React from 'react';\n\nimport { CARET_ICON_SIZE } from '../../consts';\n\nexport interface ICaret {\n  isExpanded: boolean;\n}\n\nexport const Caret: React.FunctionComponent<ICaret> = ({ isExpanded }) => (\n  <Flex pl={3} w={8} ml={-8} color=\"muted\" role=\"button\" justifyContent=\"center\">\n    <Icon size={CARET_ICON_SIZE} fixedWidth icon={isExpanded ? 'chevron-down' : 'chevron-right'} />\n  </Flex>\n);\n","import { MarkdownViewer } from '@stoplight/markdown-viewer';\nimport { Box, Link, Text } from '@stoplight/mosaic';\nimport * as React from 'react';\n\nexport const Description: React.FunctionComponent<{ value: string }> = ({ value }) => {\n  const [showAll, setShowAll] = React.useState(false);\n\n  const paragraphs = value.split('\\n\\n');\n\n  if (paragraphs.length <= 1 || showAll) {\n    return (\n      <Box\n        as={MarkdownViewer}\n        markdown={value}\n        style={{\n          fontSize: 12,\n        }}\n      />\n    );\n  }\n\n  const firstParagraph = paragraphs[0];\n\n  return (\n    <Box\n      as={MarkdownViewer}\n      markdown={firstParagraph}\n      parseOptions={{\n        components: {\n          p: (props: any) => {\n            return (\n              <Box as=\"p\">\n                <Text mr={1}>{props.children}</Text>\n                <Link cursor=\"pointer\" onClick={() => setShowAll(true)}>\n                  Show all...\n                </Link>\n              </Box>\n            );\n          },\n        },\n      }}\n      style={{\n        fontSize: 12,\n      }}\n    />\n  );\n};\n","import { isRegularNode, SchemaNode } from '@stoplight/json-schema-tree';\nimport { Box } from '@stoplight/mosaic';\nimport * as React from 'react';\n\ntype FormatProps = {\n  schemaNode: SchemaNode;\n};\n\nexport const Format: React.FunctionComponent<FormatProps> = ({ schemaNode }) => {\n  if (!isRegularNode(schemaNode) || schemaNode.format === null) {\n    return null;\n  }\n\n  return <Box as=\"span\" color=\"muted\">{`<${schemaNode.format}>`}</Box>;\n};\n","import { getLastPathSegment } from '@stoplight/json';\nimport { isReferenceNode, isRegularNode, RegularNode, SchemaNodeKind } from '@stoplight/json-schema-tree';\nimport upperFirst from 'lodash/upperFirst.js';\n\nimport { isNonNullable } from '../guards/isNonNullable';\nimport { isComplexArray, isPrimitiveArray } from '../tree';\n\ntype PrintNameOptions = {\n  shouldUseRefNameFallback?: boolean;\n};\n\nexport function printName(\n  schemaNode: RegularNode,\n  { shouldUseRefNameFallback = false }: PrintNameOptions = {},\n): string | undefined {\n  if (\n    schemaNode.primaryType !== SchemaNodeKind.Array ||\n    !isNonNullable(schemaNode.children) ||\n    schemaNode.children.length === 0\n  ) {\n    return schemaNode.title ?? (shouldUseRefNameFallback ? getNodeNameFromOriginalRef(schemaNode) : undefined);\n  }\n\n  return printArrayName(schemaNode, { shouldUseRefNameFallback });\n}\n\nfunction printArrayName(\n  schemaNode: RegularNode,\n  { shouldUseRefNameFallback = false }: PrintNameOptions,\n): string | undefined {\n  if (!isNonNullable(schemaNode.children) || schemaNode.children.length === 0) {\n    return schemaNode.title ?? (shouldUseRefNameFallback ? getNodeNameFromOriginalRef(schemaNode) : undefined);\n  }\n\n  if (schemaNode.children.length === 1 && isReferenceNode(schemaNode.children[0])) {\n    return `$ref(${schemaNode.children[0].value})[]`;\n  }\n\n  if (isPrimitiveArray(schemaNode)) {\n    const val =\n      schemaNode.children?.reduce<SchemaNodeKind[] | null>((mergedTypes, child) => {\n        if (mergedTypes === null) return null;\n\n        if (!isRegularNode(child)) return null;\n\n        if (child.types !== null && child.types.length > 0) {\n          for (const type of child.types) {\n            if (mergedTypes.includes(type)) continue;\n            mergedTypes.push(type);\n          }\n        }\n\n        return mergedTypes;\n      }, []) ?? null;\n\n    return val !== null && val.length > 0 ? `array[${val.join(' or ')}]` : 'array';\n  }\n\n  if (isComplexArray(schemaNode)) {\n    const firstChild = schemaNode.children[0];\n    if (firstChild.title) {\n      return `array[${firstChild.title}]`;\n    } else if (shouldUseRefNameFallback && getNodeNameFromOriginalRef(schemaNode)) {\n      return `array[${getNodeNameFromOriginalRef(schemaNode)}]`;\n    } else if (firstChild.primaryType) {\n      return `array[${firstChild.primaryType}]`;\n    } else if (firstChild.combiners?.length) {\n      return `array[${firstChild.combiners.join('/')}]`;\n    }\n    return 'array';\n  }\n\n  return undefined;\n}\n\nfunction getNodeNameFromOriginalRef(node: RegularNode) {\n  if (typeof node.originalFragment.$ref === 'string') {\n    return upperFirst(getLastPathSegment(node.originalFragment.$ref));\n  }\n  return undefined;\n}\n","import {\n  isReferenceNode,\n  isRegularNode,\n  RegularNode,\n  SchemaCombinerName,\n  SchemaNode,\n  SchemaNodeKind,\n} from '@stoplight/json-schema-tree';\nimport { Box } from '@stoplight/mosaic';\nimport * as React from 'react';\n\nimport { printName } from '../../utils';\n\nfunction shouldRenderName(type: SchemaNodeKind | SchemaCombinerName | '$ref'): boolean {\n  return type === SchemaNodeKind.Array || type === SchemaNodeKind.Object || type === '$ref';\n}\n\nfunction getTypes(schemaNode: RegularNode): Array<SchemaNodeKind | SchemaCombinerName> {\n  return [schemaNode.types, schemaNode.combiners].reduce<Array<SchemaNodeKind | SchemaCombinerName>>(\n    (values, value) => {\n      if (value === null) {\n        return values;\n      }\n\n      values.push(...value);\n      return values;\n    },\n    [],\n  );\n}\n\nexport const Types: React.FunctionComponent<{ schemaNode: SchemaNode }> = ({ schemaNode }) => {\n  if (isReferenceNode(schemaNode)) {\n    return (\n      <Box as=\"span\" textOverflow=\"truncate\">\n        {schemaNode.value ?? '$ref'}\n      </Box>\n    );\n  }\n\n  if (!isRegularNode(schemaNode)) {\n    return null;\n  }\n\n  const types = getTypes(schemaNode);\n\n  if (types.length === 0) return null;\n\n  const rendered = types.map((type, i, { length }) => (\n    <React.Fragment key={type}>\n      <Box as=\"span\" textOverflow=\"truncate\" color=\"muted\">\n        {shouldRenderName(type) ? printName(schemaNode) ?? type : type}\n      </Box>\n      {i < length - 1 && (\n        <Box as=\"span\" key={`${i}-sep`} color=\"muted\">\n          {' or '}\n        </Box>\n      )}\n    </React.Fragment>\n  ));\n\n  return rendered.length > 1 ? <Box textOverflow=\"truncate\">{rendered}</Box> : <>{rendered}</>;\n};\nTypes.displayName = 'JsonSchemaViewer.Types';\n","import { isRegularNode, RegularNode } from '@stoplight/json-schema-tree';\nimport { Flex, HStack, Text } from '@stoplight/mosaic';\nimport { Dictionary } from '@stoplight/types';\nimport capitalize from 'lodash/capitalize.js';\nimport keys from 'lodash/keys.js';\nimport omit from 'lodash/omit.js';\nimport pick from 'lodash/pick.js';\nimport uniq from 'lodash/uniq.js';\nimport * as React from 'react';\n\nexport interface IValidations {\n  validations: Dictionary<unknown>;\n  hideExamples?: boolean;\n}\n\ntype ValidationFormat = {\n  name: string;\n  values: string[];\n};\n\nexport const numberValidationNames = [\n  'minimum',\n  'maximum',\n  'minLength',\n  'maxLength',\n  'minItems',\n  'maxItems',\n  'exclusiveMinimum',\n  'exclusiveMaximum',\n];\n\nconst exampleValidationNames = ['examples'];\n\nconst excludedValidations = ['exclusiveMinimum', 'exclusiveMaximum', 'readOnly', 'writeOnly'];\n\nconst numberValidationFormatters: Record<string, (value: unknown) => string> = {\n  minimum: value => `>= ${value}`,\n  exclusiveMinimum: value => `> ${value}`,\n  minItems: value => `>= ${value} items`,\n  minLength: value => `>= ${value} characters`,\n  maximum: value => `<= ${value}`,\n  exclusiveMaximum: value => `< ${value}`,\n  maxItems: value => `<= ${value} items`,\n  maxLength: value => `<= ${value} characters`,\n};\n\nconst createStringFormatter = (nowrap: boolean | undefined) => (value: unknown) => {\n  return nowrap && typeof value === 'string' ? value : JSON.stringify(value);\n};\n\nconst createValidationsFormatter = (name: string, options?: { exact?: boolean; nowrap?: boolean }) => (\n  value: unknown[] | unknown,\n): ValidationFormat | null => {\n  const values = Array.isArray(value) ? value : [value];\n  if (values.length) {\n    return {\n      name: options?.exact ? name : values.length > 1 ? `${name}s` : `${name}`,\n      values: values.map(createStringFormatter(options?.nowrap)),\n    };\n  }\n  return null;\n};\n\nconst validationFormatters: Record<string, (value: unknown) => ValidationFormat | null> = {\n  enum: createValidationsFormatter('Allowed value', { nowrap: true }),\n  examples: createValidationsFormatter('Example', { nowrap: true }),\n  multipleOf: createValidationsFormatter('Multiple of', { exact: true }),\n  pattern: createValidationsFormatter('Match pattern', { exact: true, nowrap: true }),\n  default: createValidationsFormatter('Default', { exact: true, nowrap: true }),\n  style: createValidationsFormatter('Style', { exact: true, nowrap: true }),\n};\n\nconst oasFormats = {\n  int32: {\n    minimum: 0 - 2 ** 31,\n    maximum: 2 ** 31 - 1,\n  },\n  int64: {\n    minimum: 0 - 2 ** 63,\n    maximum: 2 ** 63 - 1,\n  },\n  float: {\n    minimum: 0 - 2 ** 128,\n    maximum: 2 ** 128 - 1,\n  },\n  double: {\n    minimum: 0 - Number.MAX_VALUE,\n    maximum: Number.MAX_VALUE,\n  },\n  byte: {\n    pattern: '^[\\\\w\\\\d+\\\\/=]*$',\n  },\n};\n\nfunction filterOutOasFormatValidations(format: string, values: Dictionary<unknown>) {\n  if (!(format in oasFormats)) return values;\n\n  const newValues = { ...values };\n\n  for (const [key, value] of Object.entries(oasFormats[format])) {\n    if (value === newValues[key]) {\n      delete newValues[key];\n    }\n  }\n\n  return newValues;\n}\n\nexport const Validations: React.FunctionComponent<IValidations> = ({ validations, hideExamples }) => {\n  const numberValidations = pick(validations, numberValidationNames);\n  const keyValueValidations = omit(validations, [\n    ...keys(numberValidations),\n    ...excludedValidations,\n    ...(hideExamples ? exampleValidationNames : []),\n  ]);\n\n  return (\n    <>\n      <NumberValidations validations={numberValidations} />\n      <KeyValueValidations validations={keyValueValidations} />\n    </>\n  );\n};\n\nconst NumberValidations = ({\n  validations,\n}: {\n  validations: Partial<Record<typeof numberValidationNames[number], unknown>>;\n}) => {\n  const entries = Object.entries(validations);\n  if (!entries.length) {\n    return null;\n  }\n  return (\n    <HStack color=\"muted\" maxW=\"full\" spacing={1}>\n      {entries\n        .map(([key, value]) => numberValidationFormatters[key](value))\n        .map((value, i) => (\n          <Value key={i} name={value} />\n        ))}\n    </HStack>\n  );\n};\n\nconst KeyValueValidations = ({ validations }: { validations: Dictionary<unknown> }) => (\n  <>\n    {keys(validations)\n      .filter(key => Object.keys(validationFormatters).includes(key) && validations[key] !== void 0)\n      .map(key => {\n        const validation = validationFormatters[key](validations[key]);\n        if (validation) {\n          return <KeyValueValidation key={key} name={validation.name} values={validation.values} />;\n        } else {\n          return null;\n        }\n      })}\n  </>\n);\n\nconst KeyValueValidation = ({ name, values }: { name: string; values: string[] }) => {\n  return (\n    <HStack color=\"muted\" spacing={2} alignItems=\"baseline\">\n      <Text>{capitalize(name)}:</Text>\n\n      <Flex flexWrap flex={1} style={{ gap: 4 }}>\n        {uniq(values).map(value => (\n          <Value key={value} name={value} />\n        ))}\n      </Flex>\n    </HStack>\n  );\n};\n\nconst Value = ({ name }: { name: string }) => (\n  <Text px={1} bg=\"canvas-tint\" color=\"muted\" border rounded wordBreak=\"all\" maxW=\"full\">\n    {name}\n  </Text>\n);\n\nexport function validationCount(schemaNode: RegularNode) {\n  const validations = getValidationsFromSchema(schemaNode);\n  const validationKeys = keys(omit(validations, excludedValidations));\n  return uniq(validationKeys.map(key => ([...numberValidationNames].includes(key) ? 'number' : key))).length;\n}\n\nexport function getValidationsFromSchema(schemaNode: RegularNode) {\n  return {\n    ...(schemaNode.enum !== null\n      ? { enum: schemaNode.enum }\n      : // in case schemaNode is type: \"array\", check if its child have defined enum\n      schemaNode.primaryType === 'array' &&\n        schemaNode.children?.length === 1 &&\n        isRegularNode(schemaNode.children[0]) &&\n        schemaNode.children[0].enum !== null\n      ? { enum: schemaNode.children[0].enum }\n      : null),\n    ...('annotations' in schemaNode\n      ? {\n          ...(schemaNode.annotations.default !== void 0 ? { default: schemaNode.annotations.default } : null),\n          ...(schemaNode.annotations.examples ? { examples: schemaNode.annotations.examples } : null),\n        }\n      : null),\n    ...getFilteredValidations(schemaNode),\n  };\n}\n\nfunction getFilteredValidations(schemaNode: RegularNode) {\n  if (schemaNode.format !== null) {\n    return filterOutOasFormatValidations(schemaNode.format, schemaNode.validations);\n  }\n\n  return schemaNode.validations;\n}\n","import { SchemaNode } from '@stoplight/json-schema-tree';\nimport { SpaceVals, VStack } from '@stoplight/mosaic';\nimport * as React from 'react';\n\nimport { NESTING_OFFSET } from '../../consts';\nimport { useJSVOptionsContext } from '../../contexts';\nimport { SchemaRow, SchemaRowProps } from '../SchemaRow';\n\ntype ChildStackProps = {\n  childNodes: readonly SchemaNode[];\n  currentNestingLevel: number;\n  className?: string;\n  RowComponent?: React.FC<SchemaRowProps>;\n};\n\nexport const ChildStack = ({\n  childNodes,\n  currentNestingLevel,\n  className,\n  RowComponent = SchemaRow,\n}: ChildStackProps) => {\n  const { renderRootTreeLines } = useJSVOptionsContext();\n  const rootLevel = renderRootTreeLines ? 0 : 1;\n  const isRootLevel = currentNestingLevel < rootLevel;\n\n  let ml: SpaceVals | undefined;\n  if (!isRootLevel) {\n    ml = currentNestingLevel === rootLevel ? 'px' : 4;\n  }\n\n  return (\n    <VStack\n      className={className}\n      pl={isRootLevel ? undefined : NESTING_OFFSET}\n      ml={ml}\n      spacing={4}\n      fontSize=\"sm\"\n      borderL={isRootLevel ? undefined : true}\n      data-level={currentNestingLevel}\n    >\n      {childNodes.map((childNode: SchemaNode) => (\n        <RowComponent key={childNode.id} schemaNode={childNode} nestingLevel={currentNestingLevel + 1} />\n      ))}\n    </VStack>\n  );\n};\n","import { Box } from '@stoplight/mosaic';\nimport { Dictionary } from '@stoplight/types';\nimport * as React from 'react';\n\nimport { useJSVOptionsContext } from '../../contexts';\n\nexport interface IProperties {\n  required: boolean;\n  deprecated: boolean;\n  validations: Dictionary<unknown>;\n}\n\nexport const Properties: React.FunctionComponent<IProperties> = ({\n  required,\n  deprecated,\n  validations: { readOnly, writeOnly },\n}) => {\n  const { viewMode } = useJSVOptionsContext();\n\n  // Show readOnly writeOnly validations only in standalone mode and only if just one of them is present\n  const showVisibilityValidations = viewMode === 'standalone' && !!readOnly !== !!writeOnly;\n  const visibility = showVisibilityValidations ? (\n    readOnly ? (\n      <Box as=\"span\" ml={2} color=\"muted\">\n        read-only\n      </Box>\n    ) : (\n      <Box as=\"span\" ml={2} color=\"muted\">\n        write-only\n      </Box>\n    )\n  ) : null;\n\n  return (\n    <>\n      {deprecated ? (\n        <Box as=\"span\" ml={2} color=\"warning\">\n          deprecated\n        </Box>\n      ) : null}\n      {visibility}\n      {required && (\n        <Box as=\"span\" ml={2} color=\"warning\">\n          required\n        </Box>\n      )}\n    </>\n  );\n};\n","import { extractPointerFromRef, pointerToPath } from '@stoplight/json';\nimport { isReferenceNode, isRegularNode, SchemaNode } from '@stoplight/json-schema-tree';\nimport last from 'lodash/last.js';\nimport * as React from 'react';\n\nimport { isComplexArray, isNonEmptyParentNode } from '../../tree';\nimport { printName } from '../../utils';\n\ntype Choice = {\n  title: string;\n  type: SchemaNode;\n};\n\nfunction calculateChoiceTitle(node: SchemaNode, isPlural: boolean): string {\n  const primitiveSuffix = isPlural ? 's' : '';\n  if (isRegularNode(node)) {\n    const realName = printName(node, { shouldUseRefNameFallback: true });\n    if (realName) {\n      return realName;\n    }\n    return node.primaryType !== null ? node.primaryType + primitiveSuffix : 'any';\n  }\n  if (isReferenceNode(node)) {\n    if (node.value) {\n      const value = extractPointerFromRef(node.value);\n      const lastPiece = !node.error && value ? last(pointerToPath(value)) : null;\n      if (typeof lastPiece === 'string') {\n        return lastPiece.split('.')[0];\n      }\n    }\n    return '$ref' + primitiveSuffix;\n  }\n\n  return 'any';\n}\n\nfunction makeChoice(node: SchemaNode): Choice {\n  return {\n    type: node,\n    title: calculateChoiceTitle(node, false),\n  };\n}\n\nfunction makeArrayChoice(node: SchemaNode): Choice {\n  const itemTitle = calculateChoiceTitle(node, true);\n  const title = itemTitle !== 'any' ? `array[${itemTitle}]` : 'array';\n  return {\n    type: node,\n    title,\n  };\n}\n\n/**\n * Calculates type choices for a given node.\n *\n * Usually a node has one choice - only one possible type -, itself.\n * If a node is an oneOf or anyOf combiner, the possible types are the sub-types of the combiner.\n */\nexport const useChoices = (schemaNode: SchemaNode) => {\n  const choices: Choice[] = React.useMemo(() => {\n    // handle flattening of arrays that contain oneOfs, same logic as below\n    if (\n      isComplexArray(schemaNode) &&\n      isNonEmptyParentNode(schemaNode.children[0]) &&\n      shouldShowChildSelector(schemaNode.children[0])\n    ) {\n      return schemaNode.children[0].children.map(makeArrayChoice);\n    }\n\n    // if current node is a combiner, offer its children\n    if (isNonEmptyParentNode(schemaNode) && shouldShowChildSelector(schemaNode)) {\n      return schemaNode.children.map(makeChoice);\n    }\n    // regular node, single choice - itself\n    return [makeChoice(schemaNode)];\n  }, [schemaNode]);\n\n  const defaultChoice = choices[0];\n\n  const [selectedChoice, setSelectedChoice] = React.useState<Choice | undefined>(defaultChoice);\n\n  React.useEffect(() => {\n    setSelectedChoice(defaultChoice);\n  }, [defaultChoice]);\n\n  const actualSelectedChoice = selectedChoice && choices.includes(selectedChoice) ? selectedChoice : defaultChoice;\n\n  return { selectedChoice: actualSelectedChoice, setSelectedChoice, choices };\n};\n\nconst shouldShowChildSelector = (schemaNode: SchemaNode) =>\n  isNonEmptyParentNode(schemaNode) && ['anyOf', 'oneOf'].includes(schemaNode.combiners?.[0] ?? '');\n","import { faExclamationTriangle } from '@fortawesome/free-solid-svg-icons/faExclamationTriangle.js';\nimport {\n  isMirroredNode,\n  isReferenceNode,\n  isRegularNode,\n  ReferenceNode,\n  SchemaNode,\n  SchemaNodeKind,\n} from '@stoplight/json-schema-tree';\nimport { Box, Flex, Icon, Select, VStack } from '@stoplight/mosaic';\nimport { useUpdateAtom } from 'jotai/utils';\nimport last from 'lodash/last.js';\nimport * as React from 'react';\n\nimport { COMBINER_NAME_MAP } from '../../consts';\nimport { useJSVOptionsContext } from '../../contexts';\nimport { calculateChildrenToShow, isFlattenableNode, isPropertyRequired } from '../../tree';\nimport { pathCrumbsAtom } from '../PathCrumbs';\nimport { Caret, Description, Format, getValidationsFromSchema, Types, Validations } from '../shared';\nimport { ChildStack } from '../shared/ChildStack';\nimport { Properties } from '../shared/Properties';\nimport { useChoices } from './useChoices';\n\nexport interface SchemaRowProps {\n  schemaNode: SchemaNode;\n  nestingLevel: number;\n}\n\nexport const SchemaRow: React.FunctionComponent<SchemaRowProps> = ({ schemaNode, nestingLevel }) => {\n  const { defaultExpandedDepth, renderRowAddon, onGoToRef, hideExamples, renderRootTreeLines } = useJSVOptionsContext();\n\n  const setPathCrumbs = useUpdateAtom(pathCrumbsAtom);\n  const [isExpanded, setExpanded] = React.useState<boolean>(\n    !isMirroredNode(schemaNode) && nestingLevel <= defaultExpandedDepth,\n  );\n\n  const { selectedChoice, setSelectedChoice, choices } = useChoices(schemaNode);\n  const typeToShow = selectedChoice.type;\n  const description = isRegularNode(typeToShow) ? typeToShow.annotations.description : null;\n\n  const refNode = React.useMemo<ReferenceNode | null>(() => {\n    if (isReferenceNode(schemaNode)) {\n      return schemaNode;\n    }\n\n    if (\n      isRegularNode(schemaNode) &&\n      (isFlattenableNode(schemaNode) ||\n        (schemaNode.primaryType === SchemaNodeKind.Array && schemaNode.children?.length === 1))\n    ) {\n      return (schemaNode.children?.find(isReferenceNode) as ReferenceNode | undefined) ?? null;\n    }\n\n    return null;\n  }, [schemaNode]);\n\n  const isBrokenRef = typeof refNode?.error === 'string';\n\n  const rootLevel = renderRootTreeLines ? 1 : 2;\n  const childNodes = React.useMemo(() => calculateChildrenToShow(typeToShow), [typeToShow]);\n  const combiner = isRegularNode(schemaNode) && schemaNode.combiners?.length ? schemaNode.combiners[0] : null;\n  const isCollapsible = childNodes.length > 0;\n  const isRootLevel = nestingLevel < rootLevel;\n\n  return (\n    <>\n      <Flex\n        maxW=\"full\"\n        onMouseEnter={(e: any) => {\n          e.stopPropagation();\n          setPathCrumbs(selectedChoice.type);\n        }}\n      >\n        {!isRootLevel && <Box borderT w={isCollapsible ? 1 : 3} ml={-3} mr={3} mt={2} />}\n\n        <VStack spacing={1} maxW=\"full\" flex={1} ml={isCollapsible && !isRootLevel ? 2 : undefined}>\n          <Flex\n            alignItems=\"center\"\n            maxW=\"full\"\n            onClick={isCollapsible ? () => setExpanded(!isExpanded) : undefined}\n            cursor={isCollapsible ? 'pointer' : undefined}\n          >\n            {isCollapsible ? <Caret isExpanded={isExpanded} /> : null}\n\n            <Flex alignItems=\"baseline\" fontSize=\"base\" flex={1} pos=\"sticky\" top={0}>\n              {schemaNode.subpath.length > 0 && shouldShowPropertyName(schemaNode) && (\n                <Box mr={2} fontFamily=\"mono\" fontWeight=\"semibold\">\n                  {last(schemaNode.subpath)}\n                </Box>\n              )}\n\n              {choices.length === 1 && (\n                <>\n                  <Types schemaNode={typeToShow} />\n                  <Format schemaNode={typeToShow} />\n                </>\n              )}\n\n              {onGoToRef && isReferenceNode(schemaNode) && schemaNode.external ? (\n                <Box\n                  as=\"a\"\n                  ml={2}\n                  cursor=\"pointer\"\n                  color=\"primary-light\"\n                  onClick={(e: React.MouseEvent) => {\n                    e.preventDefault();\n                    e.stopPropagation();\n                    onGoToRef(schemaNode);\n                  }}\n                >\n                  (go to ref)\n                </Box>\n              ) : null}\n\n              {schemaNode.subpath.length > 1 && schemaNode.subpath[0] === 'patternProperties' ? (\n                <Box ml={2} color=\"muted\">\n                  (pattern property)\n                </Box>\n              ) : null}\n\n              {choices.length > 1 && (\n                <Select\n                  aria-label=\"Pick a type\"\n                  size=\"sm\"\n                  triggerTextPrefix={combiner ? `${COMBINER_NAME_MAP[combiner]}: ` : undefined}\n                  options={choices.map((choice, index) => ({\n                    value: String(index),\n                    label: choice.title,\n                  }))}\n                  value={\n                    String(choices.indexOf(selectedChoice))\n                    /* String to work around https://github.com/stoplightio/mosaic/issues/162 */\n                  }\n                  onChange={selectedIndex => setSelectedChoice(choices[selectedIndex as number])}\n                />\n              )}\n            </Flex>\n\n            <Properties\n              required={isPropertyRequired(schemaNode)}\n              deprecated={isRegularNode(schemaNode) && schemaNode.deprecated}\n              validations={isRegularNode(schemaNode) ? schemaNode.validations : {}}\n            />\n          </Flex>\n\n          {typeof description === 'string' && description.length > 0 && <Description value={description} />}\n\n          <Validations\n            validations={isRegularNode(schemaNode) ? getValidationsFromSchema(schemaNode) : {}}\n            hideExamples={hideExamples}\n          />\n\n          {isBrokenRef && (\n            // TODO (JJ): Add mosaic tooltip showing ref error\n            <Icon title={refNode!.error!} color=\"danger\" icon={faExclamationTriangle} size=\"sm\" />\n          )}\n        </VStack>\n\n        {renderRowAddon ? <Box>{renderRowAddon({ schemaNode, nestingLevel })}</Box> : null}\n      </Flex>\n\n      {isCollapsible && isExpanded ? <ChildStack childNodes={childNodes} currentNestingLevel={nestingLevel} /> : null}\n    </>\n  );\n};\n\nfunction shouldShowPropertyName(schemaNode: SchemaNode) {\n  return (\n    schemaNode.subpath.length === 2 &&\n    (schemaNode.subpath[0] === 'properties' || schemaNode.subpath[0] === 'patternProperties')\n  );\n}\n","import { RefObject, useEffect, useRef, useState } from 'react';\n\nexport const useIsOnScreen = (ref: RefObject<HTMLElement>) => {\n  const observerRef = useRef<IntersectionObserver | null>(null);\n  const [isOnScreen, setIsOnScreen] = useState(true);\n\n  useEffect(() => {\n    if (ref.current) {\n      const scrollParent = getScrollParent(ref.current);\n      observerRef.current = new IntersectionObserver(\n        ([entry]) => {\n          setIsOnScreen(entry.isIntersecting);\n        },\n        {\n          root: scrollParent === window ? undefined : (scrollParent as HTMLElement),\n          rootMargin: '20px 0px 0px 0px',\n        },\n      );\n\n      observerRef.current.observe(ref.current);\n    }\n\n    return () => {\n      observerRef.current?.disconnect();\n    };\n  }, [ref]);\n\n  return isOnScreen;\n};\n\nfunction getScrollParent(node: HTMLElement | null): HTMLElement | typeof window | null {\n  if (node == null) {\n    return null;\n  }\n\n  if (node.scrollHeight > node.clientHeight) {\n    return node.tagName === 'HTML' ? window : node;\n  } else {\n    return getScrollParent(node.parentElement);\n  }\n}\n","import { faCaretDown } from '@fortawesome/free-solid-svg-icons/faCaretDown.js';\nimport { isRegularNode, RegularNode } from '@stoplight/json-schema-tree';\nimport { Box, Flex, HStack, Icon, Menu, Pressable } from '@stoplight/mosaic';\nimport { useUpdateAtom } from 'jotai/utils';\nimport * as React from 'react';\n\nimport { COMBINER_NAME_MAP } from '../../consts';\nimport { useIsOnScreen } from '../../hooks/useIsOnScreen';\nimport { calculateChildrenToShow, isComplexArray } from '../../tree';\nimport { showPathCrumbsAtom } from '../PathCrumbs';\nimport { ChildStack } from '../shared/ChildStack';\nimport { SchemaRow, SchemaRowProps } from './SchemaRow';\nimport { useChoices } from './useChoices';\n\nexport const TopLevelSchemaRow = ({ schemaNode }: Pick<SchemaRowProps, 'schemaNode'>) => {\n  const { selectedChoice, setSelectedChoice, choices } = useChoices(schemaNode);\n  const childNodes = React.useMemo(() => calculateChildrenToShow(selectedChoice.type), [selectedChoice.type]);\n  const nestingLevel = 0;\n\n  // regular objects are flattened at the top level\n  if (isRegularNode(schemaNode) && isPureObjectNode(schemaNode)) {\n    return (\n      <>\n        <ScrollCheck />\n        <ChildStack childNodes={childNodes} currentNestingLevel={nestingLevel} />\n      </>\n    );\n  }\n\n  if (isRegularNode(schemaNode) && choices.length > 1) {\n    const combiner = isRegularNode(schemaNode) && schemaNode.combiners?.length ? schemaNode.combiners[0] : null;\n\n    return (\n      <>\n        <ScrollCheck />\n\n        <HStack spacing={3} pb={4}>\n          <Menu\n            aria-label=\"Pick a type\"\n            closeOnPress\n            placement=\"bottom left\"\n            items={choices.map((choice, index) => ({\n              id: index,\n              title: choice.title,\n              onPress: () => setSelectedChoice(choice),\n            }))}\n            renderTrigger={props => (\n              <Pressable {...props}>\n                <Flex fontFamily=\"mono\" fontWeight=\"semibold\" cursor=\"pointer\" fontSize=\"base\">\n                  {selectedChoice.title}\n                  <Box ml={1}>\n                    <Icon icon={faCaretDown} />\n                  </Box>\n                </Flex>\n              </Pressable>\n            )}\n          />\n\n          {combiner !== null ? (\n            <Flex alignItems=\"center\" color=\"muted\" fontSize=\"base\">\n              {`(${COMBINER_NAME_MAP[combiner]})`}\n            </Flex>\n          ) : null}\n        </HStack>\n\n        {childNodes.length > 0 ? <ChildStack childNodes={childNodes} currentNestingLevel={nestingLevel} /> : null}\n      </>\n    );\n  }\n\n  if (isComplexArray(schemaNode) && isPureObjectNode(schemaNode.children[0])) {\n    return (\n      <>\n        <ScrollCheck />\n\n        <Box fontFamily=\"mono\" fontWeight=\"semibold\" fontSize=\"base\" pb={4}>\n          array of:\n        </Box>\n\n        {childNodes.length > 0 ? <ChildStack childNodes={childNodes} currentNestingLevel={nestingLevel} /> : null}\n      </>\n    );\n  }\n\n  return (\n    <>\n      <ScrollCheck />\n      <SchemaRow schemaNode={schemaNode} nestingLevel={nestingLevel} />\n    </>\n  );\n};\n\nfunction ScrollCheck() {\n  const elementRef = React.useRef<HTMLDivElement>(null);\n\n  const isOnScreen = useIsOnScreen(elementRef);\n  const setShowPathCrumbs = useUpdateAtom(showPathCrumbsAtom);\n  React.useEffect(() => {\n    setShowPathCrumbs(!isOnScreen);\n  }, [isOnScreen, setShowPathCrumbs]);\n\n  return <div ref={elementRef} />;\n}\n\nfunction isPureObjectNode(schemaNode: RegularNode) {\n  return schemaNode.primaryType === 'object' && schemaNode.types?.length === 1;\n}\n","import {\n  isRegularNode,\n  RootNode,\n  SchemaNode,\n  SchemaTree as JsonSchemaTree,\n  SchemaTreeRefDereferenceFn,\n} from '@stoplight/json-schema-tree';\nimport { Box, Provider as MosaicProvider } from '@stoplight/mosaic';\nimport { ErrorBoundaryForwardedProps, FallbackProps, withErrorBoundary } from '@stoplight/react-error-boundary';\nimport cn from 'classnames';\nimport { Provider } from 'jotai';\nimport { useUpdateAtom } from 'jotai/utils';\nimport * as React from 'react';\n\nimport { JSVOptions, JSVOptionsContextProvider } from '../contexts';\nimport type { JSONSchema } from '../types';\nimport { PathCrumbs, pathCrumbsAtom } from './PathCrumbs';\nimport { TopLevelSchemaRow } from './SchemaRow';\n\nexport type JsonSchemaProps = Partial<JSVOptions> & {\n  schema: JSONSchema;\n  emptyText?: string;\n  className?: string;\n  resolveRef?: SchemaTreeRefDereferenceFn;\n  onTreePopulated?: (props: { rootNode: RootNode; nodeCount: number }) => void;\n  maxHeight?: number;\n  parentCrumbs?: string[];\n};\n\nconst JsonSchemaViewerComponent = ({\n  viewMode = 'standalone',\n  defaultExpandedDepth = 1,\n  onGoToRef,\n  renderRowAddon,\n  hideExamples,\n  renderRootTreeLines,\n  disableCrumbs,\n  ...rest\n}: JsonSchemaProps & ErrorBoundaryForwardedProps) => {\n  const options = React.useMemo(\n    () => ({\n      defaultExpandedDepth,\n      viewMode,\n      onGoToRef,\n      renderRowAddon,\n      hideExamples,\n      renderRootTreeLines,\n      disableCrumbs,\n    }),\n    [defaultExpandedDepth, viewMode, onGoToRef, renderRowAddon, hideExamples, renderRootTreeLines, disableCrumbs],\n  );\n\n  return (\n    <MosaicProvider>\n      <JSVOptionsContextProvider value={options}>\n        <Provider>\n          <JsonSchemaViewerInner viewMode={viewMode} {...rest} />\n        </Provider>\n      </JSVOptionsContextProvider>\n    </MosaicProvider>\n  );\n};\n\nconst JsonSchemaViewerInner = ({\n  schema,\n  viewMode,\n  className,\n  resolveRef,\n  emptyText = 'No schema defined',\n  onTreePopulated,\n  maxHeight,\n  parentCrumbs,\n}: Pick<\n  JsonSchemaProps,\n  'schema' | 'viewMode' | 'className' | 'resolveRef' | 'emptyText' | 'onTreePopulated' | 'maxHeight' | 'parentCrumbs'\n>) => {\n  const setPathCrumbs = useUpdateAtom(pathCrumbsAtom);\n  const onMouseLeave = React.useCallback(() => {\n    setPathCrumbs([]);\n  }, [setPathCrumbs]);\n\n  const { jsonSchemaTreeRoot, nodeCount } = React.useMemo(() => {\n    const jsonSchemaTree = new JsonSchemaTree(schema, {\n      mergeAllOf: true,\n      refResolver: resolveRef,\n    });\n\n    let nodeCount = 0;\n    const shouldNodeBeIncluded = (node: SchemaNode) => {\n      if (!isRegularNode(node)) return true;\n\n      const { validations } = node;\n\n      if (!!validations.writeOnly === !!validations.readOnly) {\n        return true;\n      }\n\n      return !((viewMode === 'read' && !!validations.writeOnly) || (viewMode === 'write' && !!validations.readOnly));\n    };\n\n    jsonSchemaTree.walker.hookInto('filter', node => {\n      if (shouldNodeBeIncluded(node)) {\n        nodeCount++;\n        return true;\n      }\n      return false;\n    });\n    jsonSchemaTree.populate();\n\n    return {\n      jsonSchemaTreeRoot: jsonSchemaTree.root,\n      nodeCount,\n    };\n  }, [schema, resolveRef, viewMode]);\n\n  React.useEffect(() => {\n    onTreePopulated?.({\n      rootNode: jsonSchemaTreeRoot,\n      nodeCount: nodeCount,\n    });\n  }, [jsonSchemaTreeRoot, onTreePopulated, nodeCount]);\n\n  const isEmpty = React.useMemo(() => jsonSchemaTreeRoot.children.every(node => !isRegularNode(node) || node.unknown), [\n    jsonSchemaTreeRoot,\n  ]);\n  if (isEmpty) {\n    return (\n      <Box className={cn(className, 'JsonSchemaViewer')} fontSize=\"sm\">\n        {emptyText}\n      </Box>\n    );\n  }\n\n  return (\n    <Box\n      className={cn('JsonSchemaViewer', className)}\n      pos={maxHeight ? 'relative' : undefined}\n      overflowY={maxHeight ? 'auto' : undefined}\n      onMouseLeave={onMouseLeave}\n      style={{ maxHeight }}\n    >\n      <PathCrumbs parentCrumbs={parentCrumbs} />\n      <TopLevelSchemaRow schemaNode={jsonSchemaTreeRoot.children[0]} />\n    </Box>\n  );\n};\n\nconst JsonSchemaFallbackComponent = ({ error }: FallbackProps) => {\n  return (\n    <Box p={4}>\n      <Box as=\"b\" color=\"danger\">\n        Error\n      </Box>\n      {error !== null ? `: ${error.message}` : null}\n    </Box>\n  );\n};\n\nexport const JsonSchemaViewer = withErrorBoundary<JsonSchemaProps>(JsonSchemaViewerComponent, {\n  FallbackComponent: JsonSchemaFallbackComponent,\n  recoverableProps: ['schema'],\n});\n"],"names":["MosaicProvider","Provider","JsonSchemaTree"],"mappings":"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"}